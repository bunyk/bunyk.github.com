<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Taras Bunyk</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/688040b3fc223486cedc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/688040b3fc223486cedc.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons-131aad2d92e69c360009.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-4f9408d32df08544de44.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" as="script"/><link rel="preload" href="/_next/static/chunks/762-bec077d9715dbffe23e5.js" as="script"/><link rel="preload" href="/_next/static/chunks/493-6f47d80e13ed5af25ee4.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/tag/%5Btag%5D/page/%5Bpage%5D-ca3b8c5356a256900a0e.js" as="script"/></head><body><div id="__next"><div class="MuiContainer-root MuiContainer-maxWidthMd"><div class="MuiToolbar-root MuiToolbar-regular jss2 MuiToolbar-gutters"><h1 class="MuiTypography-root jss3 MuiTypography-h5 MuiTypography-noWrap" aligh="center">Taras Bunyk</h1></div><nav class="MuiToolbar-root MuiToolbar-dense jss4 MuiToolbar-gutters"><a href="/">Home</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-5"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-9"><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.5.1 Generic arithmetic operations</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-09-02 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>In <a href="/posts/sicp2.4/">previous post</a> I have used wrong StackOverflow answer. :) Or, to be more precise, right answer for that section, but useless here, as we want to store in table functions for multiple arguments.</p>
<p><a href="https://stackoverflow.com/a/19114031/816449">Correct answer</a> that supports lists looks like this:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> *op-table* (<span class="hljs-name">make-hash-table</span>))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">put</span> op type proc)
  (<span class="hljs-name">hash-table/put!</span> *op-table* (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> op type) proc))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">get</span> op type)
  (<span class="hljs-name">hash-table/get</span> *op-table* (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> op type) <span class="hljs-literal">#f</span>))</code></pre></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.5.1"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.4 Multiple representations for abstract data</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-08-26 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>I went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)</p>
<p><a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html">Link to the chapter</a></p>
<p>In this chapter we will need <code>get</code> and <code>put</code> functions which could be implemented by similar system functions.</p>
<p>Found this on <a href="https://stackoverflow.com/a/29465496/816449">StackOverflow</a>, of course.</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> put <span class="hljs-number">2</span>d-put!)
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">get</span> a b)
    <span class="hljs-comment">;(display "get ") (display a) (display b) (newline)</span>
    (<span class="hljs-name">2d-get</span> a b)
)</code></pre></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.4"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.3.4 Huffman encoding</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-08-02 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>Exercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.3.4"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.3.3 Representing sets</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-28 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>This was more boring in comparison to previous section, probably because it required writing less code, and just writing more explanations. Writing is thinking, so I tried to do that. Or maybe it was boring because sets are not as exciting as symbolic differentiation. At least when you have high level language.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.3.3"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.3.2 Symbolic differentiation</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-26 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>I decided to skip picture language, because of technical reasons. Also, 2.3.1 I'll do in this post, because it was just to short. Here we get one step clother to build interpreter, not yet for programming language, but at least for mathematical expressions.</p>
<p>And now we are in the <a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-16.html#%25_sec_2.3">middle of second chapter</a>.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.3.2"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.2.3 Sequences as Conventional Interfaces</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-23 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>Here we become skilled in list manipulation and build a set of useful subroutines.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.2.3"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.2.2 Hierarchical structures</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-19 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>AKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.</p>
<p>Also here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is "What would interpreter print", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.2.2"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.2.1 Sequences</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-16 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>Finally, the thing Lisp was named after.</p>
<p>Fix MIT Scheme to be like SICP scheme using this:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> nil '())</code></pre></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.2.1"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.1.4: Interval arithmetic</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-15 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>Less mind-blowing ideas, more practice.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.1.4"><span class="MuiButton-label">More</span></a></div></div><div class="MuiPaper-root MuiCard-root jss1 MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.1.3 Meaning of data</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-10 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>This section blows your mind by showing that data could be represented by functions. That's kid of obvious that array or assotiative array could be replaced by function that returns value by index, but here you replace with functions even the most basic data type - integer. Not for practical reasons, but I guess to achieve satory about lambda calculus.</p></div><div class="MuiCardActions-root MuiCardActions-spacing"><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/posts/sicp2.1.3"><span class="MuiButton-label">More</span></a></div></div><button class="MuiButtonBase-root MuiButton-root MuiButton-text Mui-disabled Mui-disabled" tabindex="-1" type="button" disabled=""><span class="MuiButton-label">1</span></button><a class="MuiButtonBase-root MuiButton-root MuiButton-text" tabindex="0" aria-disabled="false" href="/tag/SICP/page/2"><span class="MuiButton-label">2</span></a></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-3"><h6 class="MuiTypography-root jss6 MuiTypography-h6 MuiTypography-gutterBottom">Archives</h6><ul><li><a href="/month/2018-12/page/1">2018-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2020-06/page/1">2020-06</a> <span title="posts count">(<!-- -->7<!-- -->)</span></li><li><a href="/month/2020-07/page/1">2020-07</a> <span title="posts count">(<!-- -->10<!-- -->)</span></li><li><a href="/month/2020-08/page/1">2020-08</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-09/page/1">2020-09</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-12/page/1">2020-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2021-01/page/1">2021-01</a> <span title="posts count">(<!-- -->4<!-- -->)</span></li></ul><h6 class="MuiTypography-root jss6 MuiTypography-h6 MuiTypography-gutterBottom">Topics</h6><ul><li><a href="/tag/MOOC/page/1">MOOC</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/tag/SICP/page/1">SICP</a> <span title="posts count">(<!-- -->20<!-- -->)</span></li><li><a href="/tag/ideas/page/1">ideas</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/tag/notes/page/1">notes</a> <span title="posts count">(<!-- -->5<!-- -->)</span></li><li><a href="/tag/on%20writing/page/1">on writing</a> <span title="posts count">(<!-- -->3<!-- -->)</span></li></ul></div><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">© <!-- -->2021<!-- --> Bunyk Taras. Built with Material UI &amp; Next.js</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"pageNumber":"1","posts":[{"id":"sicp2.5.1","title":"SICP 2.5.1 Generic arithmetic operations","date":"2020-09-02","tags":["SICP"],"excerpt":"\u003cp\u003eIn \u003ca href=\"/posts/sicp2.4/\"\u003eprevious post\u003c/a\u003e I have used wrong StackOverflow answer. :) Or, to be more precise, right answer for that section, but useless here, as we want to store in table functions for multiple arguments.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/a/19114031/816449\"\u003eCorrect answer\u003c/a\u003e that supports lists looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003emake-hash-table\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e op type proc)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/put!\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) proc))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e op type)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/get\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e","content":"\u003cp\u003eIn \u003ca href=\"/posts/sicp2.4/\"\u003eprevious post\u003c/a\u003e I have used wrong StackOverflow answer. :) Or, to be more precise, right answer for that section, but useless here, as we want to store in table functions for multiple arguments.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/a/19114031/816449\"\u003eCorrect answer\u003c/a\u003e that supports lists looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003emake-hash-table\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e op type proc)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/put!\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) proc))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e op type)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/get\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAlso I needed to copypaste a lot of code to be able to start working on \u003ca href=\"#exercise-2-77\"\u003efirst exercise\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e type-tag contents)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e type-tag contents))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etype-tag\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- TYPE-TAG\"\u003c/span\u003e datum)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003econtents\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- CONTENTS\"\u003c/span\u003e datum)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e op . args)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003etype-tags\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e type-tag args)))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eproc\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e op type-tags)))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e proc\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eapply\u003c/span\u003e\u003c/span\u003e proc (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e contents args))\n          (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003e\"No method for these types -- APPLY-GENERIC\"\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e op type-tags))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e z))\n\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x y))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z))\n             (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z)))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eatan\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z)))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecos\u003c/span\u003e\u003c/span\u003e a)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esin\u003c/span\u003e\u003c/span\u003e a))))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to the rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e x))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(rectangular) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(rectangular) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(rectangular) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(rectangular) angle)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-polar-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e r a))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecos\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esin\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e y)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eatan\u003c/span\u003e\u003c/span\u003e y x)))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to the rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e x))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(polar) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(polar) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(polar) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(polar) angle)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-complex-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; imported procedures from rectangular and polar packages\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y)\n    ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e) x y))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a)\n    ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e) r a))\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z2))\n                         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z2))\n                         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z2))\n                       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z2))\n                       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eangle\u003c/span\u003e\u003c/span\u003e z2))))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(complex) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(complex) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(complex) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(complex) angle)\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-complex-package\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.77\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e z (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt calls \u003ccode\u003eapply-generic\u003c/code\u003e to do operation \u003ccode\u003e'magnitude\u003c/code\u003e with z\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eapply-generic\u003c/code\u003e looks for operation \u003ccode\u003e'magnitude\u003c/code\u003e for \u003ccode\u003e'complex\u003c/code\u003e numbers, and applies it to value inside\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eapply\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat operation, thanks to Alyssa P. Hacker, is just application of same \u003ccode\u003emagnitude\u003c/code\u003e function, but this time for \u003ccode\u003e'rectangular\u003c/code\u003e object\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eapply-generic applies operation 'magnitude for 'rectangular type to content of rectangular \"package\":\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eapply\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhich is \u003ccode\u003emagnitude\u003c/code\u003e function from inside rectangular package\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n         (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.78\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e type-tag contents)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e type-tag \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e)\n    contents\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e type-tag contents)\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etype-tag\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e datum) \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e datum))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- TYPE-TAG\"\u003c/span\u003e datum))\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003econtents\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e datum) datum)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e datum))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- CONTENTS\"\u003c/span\u003e datum))\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo test:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e x y))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-scheme-number-package\u003c/span\u003e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x)\n    (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e x))    \n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x)))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-scheme-number-package\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.79\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e '(scheme-number scheme-number) =)\n\n(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e '(complex complex)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e y))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e y))\n    ))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eequ?\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e x y))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.80\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e '(scheme-number)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e '(complex)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e x) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ezero?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e x))\u003c/code\u003e\u003c/pre\u003e"},{"id":"sicp2.4","title":"SICP 2.4 Multiple representations for abstract data","date":"2020-08-26","tags":["SICP"],"excerpt":"\u003cp\u003eI went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html\"\u003eLink to the chapter\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn this chapter we will need \u003ccode\u003eget\u003c/code\u003e and \u003ccode\u003eput\u003c/code\u003e functions which could be implemented by similar system functions.\u003c/p\u003e\n\u003cp\u003eFound this on \u003ca href=\"https://stackoverflow.com/a/29465496/816449\"\u003eStackOverflow\u003c/a\u003e, of course.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e put \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003ed-put!)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e a b)\n    \u003cspan class=\"hljs-comment\"\u003e;(display \"get \") (display a) (display b) (newline)\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e2d-get\u003c/span\u003e a b)\n)\u003c/code\u003e\u003c/pre\u003e","content":"\u003cp\u003eI went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html\"\u003eLink to the chapter\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn this chapter we will need \u003ccode\u003eget\u003c/code\u003e and \u003ccode\u003eput\u003c/code\u003e functions which could be implemented by similar system functions.\u003c/p\u003e\n\u003cp\u003eFound this on \u003ca href=\"https://stackoverflow.com/a/29465496/816449\"\u003eStackOverflow\u003c/a\u003e, of course.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e put \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003ed-put!)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e a b)\n    \u003cspan class=\"hljs-comment\"\u003e;(display \"get \") (display a) (display b) (newline)\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e2d-get\u003c/span\u003e a b)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd some setup from \u003ca href=\"/posts/sicp2.3.2/\"\u003eprevious section\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e variable? symbol?)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e v1 v2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v1) (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v2) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e v1 v2)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e exp num)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e exp num)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.73\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e exp var)\n   (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n         ((\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e exp var) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperator\u003c/span\u003e exp)) (\u003cspan class=\"hljs-name\"\u003eoperands\u003c/span\u003e exp)\n                                            var))))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperator\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperands\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ea) So, in our new derive we do lookup in table instead of \u003ccode\u003econd\u003c/code\u003e expression. We are not able to move \u003ccode\u003enumber?\u003c/code\u003e into lookup, because \u003ccode\u003enumber?\u003c/code\u003e is condition for a set of values, not just one value, and table works only with one value.\u003c/p\u003e\n\u003cp\u003eb)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e args) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e items total nonnum)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n            ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e items)\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e nonnum)\n                    total\n                    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e total \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n                                nonnum\n                                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e total nonnum)\n                    ))\n                )\n            )\n            ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items))\n                (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) total) nonnum))\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items) total (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) nonnum)))\n        )\n    )\n    (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e args \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e '())\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e m1 m2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e m1 m2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m1 m2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-derivatives-package\u003c/span\u003e) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-sum\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (e) (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e e var)) items))\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e deriv-sum)\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-prod\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003etail\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e items))\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e items)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items))\n        )\n    ))\n        (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \n           (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items)\n                      (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e tail var))\n           (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) var)\n                      tail)\n        ))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e deriv-sum)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e deriv-prod)\n)\n(\u003cspan class=\"hljs-name\"\u003einstall-derivatives-package\u003c/span\u003e) \u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI think I wrote too much code here because I wanted to support sums and products of multiple arguments.\u003c/p\u003e\n\u003cp\u003ec) Exponentation\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-exp\u003c/span\u003e base e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) base)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e base e))))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-exp\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n        (\u003cspan class=\"hljs-name\"\u003ebase\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items))\n        (\u003cspan class=\"hljs-name\"\u003ee\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e items))\n    )\n        (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e\n            e\n            (\u003cspan class=\"hljs-name\"\u003emake-exp\u003c/span\u003e base (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e deriv-exp)\n\n(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(+ (** x \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (** x \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ed) We could switch arguments inside \u003ccode\u003eget\u003c/code\u003e, or inside \u003ccode\u003eput\u003c/code\u003e, or switch arguments when we call put. That's all what will be needed.\u003c/p\u003e\n\u003ch2\u003eExercise 2.74\u003c/h2\u003e\n\u003cp\u003eI skipped it because it is too abstract.\u003c/p\u003e\n\u003ch2\u003eExercise 2.75\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edispatch\u003c/span\u003e op)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecos\u003c/span\u003e\u003c/span\u003e a)))\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esin\u003c/span\u003e\u003c/span\u003e a)))\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e) r)\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e) a)\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n           (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Unknown op -- MAKE-FROM-REAL-IMAG\"\u003c/span\u003e op))))\n  dispatch)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.76\u003c/h2\u003e\n\u003cp\u003eSkip this too. Because I see no way to verify that I did it correctly. Learning needs feedback.\u003c/p\u003e"},{"id":"sicp2.3.4","title":"SICP 2.3.4 Huffman encoding","date":"2020-08-02","tags":["SICP"],"excerpt":"\u003cp\u003eExercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.\u003c/p\u003e","content":"\u003cp\u003eExercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.\u003c/p\u003e\n\u003ch2\u003eExercise 2.67\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e symbol weight)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e symbol weight))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e object)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e object) \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e x))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e x))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e left\n        right\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e right))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e right))))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e tree))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e tree))\n      (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e tree)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003ecadddr\u003c/span\u003e tree)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e bits tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits current-branch)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e bits)\n        '()\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003enext-branch\u003c/span\u003e\n               (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e bits) current-branch)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e next-branch)\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e next-branch)\n                    (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) tree))\n              (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) next-branch)))))\n  (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e bit branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e branch))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e branch))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"bad bit -- CHOOSE-BRANCH\"\u003c/span\u003e bit))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-tree\n  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'A\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n                  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e\n                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'B\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n                   (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'D\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n                                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'C\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-message '(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e sample-message sample-tree)\n\u003cspan class=\"hljs-comment\"\u003e;Value 14: (a d a b b c a)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.68\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e message tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e message)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e message) tree)\n              (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e message) tree))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym tree)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n        ((\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree) '())\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree))))\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree))))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"encode-symbol fails for symbol\"\u003c/span\u003e sym \u003cspan class=\"hljs-string\"\u003e\" with tree \"\u003c/span\u003e tree))\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set)))\n    )\n)\n\n\n(\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e '(a d a b b c a) sample-tree)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.69\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e pairs)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003epair\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pairs)))\n        (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair)    \u003cspan class=\"hljs-comment\"\u003e; symbol\u003c/span\u003e\n                               (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))  \u003cspan class=\"hljs-comment\"\u003e; frequency\u003c/span\u003e\n                    (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e pairs))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e forest)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e forest)) \u003cspan class=\"hljs-comment\"\u003e; single element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest) \u003cspan class=\"hljs-comment\"\u003e; means we merged all trees and could return the only element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ( \u003cspan class=\"hljs-comment\"\u003e; othwerise let's take two smallest\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003esmallest1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003esmallest2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003etail\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e forest))\n        )\n            (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e smallest1 smallest2) \u003cspan class=\"hljs-comment\"\u003e; merge them\u003c/span\u003e\n                tail \u003cspan class=\"hljs-comment\"\u003e; and add to the remaining set of trees\u003c/span\u003e\n            ))\n        )\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '((a \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (b \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (c \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.70\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-code (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '(\n    (A \t    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (BOOM \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    (GET \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (JOB \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (NA \t\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e)\n    (SHA \t\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    (YIP \t\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e)\n    (WAH \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \n)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-song '(Get a job\n\nSha na na na na na na na na\n\nGet a job\n\nSha na na na na na na na na\n\nWah yip yip yip yip yip yip yip yip yip\n\nSha boom\n))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHow many bits are required for encoding?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e rock-song rock-code))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 84\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhat is the smallest number of bits that would be needed to encode this song if we used a fixed-length code for the eight-symbol alphabet?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e rock-song))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 108\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.71\u003c/h2\u003e\n\u003cp\u003eMost frequent symbol is encoded in one bit, least frequent - in n bits.\u003c/p\u003e\n\u003ch2\u003eExercise 2.72\u003c/h2\u003e\n\u003cp\u003eIf search in set is linear, then for the most frequent symbol endoing is done in O(n), for the least frequent - in O(n2). If search is done in log(n) - then encoding could be done from log(n) to n*log(n)\u003c/p\u003e"},{"id":"sicp2.3.3","title":"SICP 2.3.3 Representing sets","date":"2020-07-28","tags":["SICP"],"excerpt":"\u003cp\u003eThis was more boring in comparison to previous section, probably because it required writing less code, and just writing more explanations. Writing is thinking, so I tried to do that. Or maybe it was boring because sets are not as exciting as symbolic differentiation. At least when you have high level language.\u003c/p\u003e","content":"\u003cp\u003eThis was more boring in comparison to previous section, probably because it required writing less code, and just writing more explanations. Writing is thinking, so I tried to do that. Or maybe it was boring because sets are not as exciting as symbolic differentiation. At least when you have high level language.\u003c/p\u003e\n\u003ch2\u003eExercise 2.59\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) false)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) true)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n      set\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e set1 set2)\n  (\u003cspan class=\"hljs-name\"\u003efold-left\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (union next) (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e next union))\n    set1\n    set2\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.60\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) false)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) true)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set)))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eO(n), as unique one, but here list could be way longer, so less performant.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eO(1), lot better than unique one ( O(n)), because we not checking uniqueness.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e set1 set2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e set1 set2)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAppend has complexity O(n) = O(len(set1)) if I'm not mistaken. O(n), better than O(n2).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eintersection-set\u003c/span\u003e set1 set2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set2)) '())\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set1) set2)        \n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set1)\n               (\u003cspan class=\"hljs-name\"\u003eintersection-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set1) set2)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eintersection-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set1) set2))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIntersection has same implementation and as a result same asymptotic complexity O(n2), but we expect n to be a lot larger.\u003c/p\u003e\n\u003cp\u003eSo, this approach would suit applications where we will do a lot of adjoins and unions, and not much checking for element or intersections.\u003c/p\u003e\n\u003ch2\u003eExercise 2.61\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) set)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.62\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e set1 set2)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set1) set2)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set2) set1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set1) (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set1) set2)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set2) (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e set1 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set2))))\n    )\n)\n(\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.63\u003c/h2\u003e\n\u003cp\u003ea. Yes, they give same results by traversing tree from left to right.\u003c/p\u003e\n\u003cp\u003eb. One without \u003ccode\u003eappend\u003c/code\u003e is better. For the second one \u003ccode\u003ecopy-to-list\u003c/code\u003e is called for right subtree first, and then process conses current tree entry to result, then \u003ccode\u003ecopy-to-list\u003c/code\u003e is called recursively to cons left subtree to the resulting list.\u003c/p\u003e\n\u003cp\u003eIn case with append, we compute \u003ccode\u003etree-\u003elist1\u003c/code\u003e for both subtrees simultaniously, then iterate over result for left subtree inside \u003ccode\u003eappend\u003c/code\u003e.  Append takes O(n) time, where n is length of left argument. It is processing half of nodes in each level in the tree, which is approximately O(n log(n)).\u003c/p\u003e\n\u003ch2\u003eExercise 2.64\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elist-\u003etree\u003c/span\u003e elements)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epartial-tree\u003c/span\u003e elements (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e elements))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epartial-tree\u003c/span\u003e elts n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e '() elts)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eleft-size\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003equotient\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eleft-result\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epartial-tree\u003c/span\u003e elts left-size)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eleft-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e left-result))\n                (\u003cspan class=\"hljs-name\"\u003enon-left-elts\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e left-result))\n                (\u003cspan class=\"hljs-name\"\u003eright-size\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e left-size \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))))\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ethis-entry\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e non-left-elts))\n                  (\u003cspan class=\"hljs-name\"\u003eright-result\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epartial-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e non-left-elts)\n                                              right-size)))\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eright-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e right-result))\n                    (\u003cspan class=\"hljs-name\"\u003eremaining-elts\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e right-result)))\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-tree\u003c/span\u003e this-entry left-tree right-tree)\n                      remaining-elts))))))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003epartial-tree\u003c/code\u003e takes as arguments \u003ccode\u003eelts\u003c/code\u003e - list of elements, and integer \u003ccode\u003en\u003c/code\u003e and returns pair whose \u003ccode\u003ecar\u003c/code\u003e is balanced tree containing the first \u003ccode\u003en\u003c/code\u003e elements of the list and \u003ccode\u003ecdr\u003c/code\u003e is the list of elements not included in the tree.\u003c/p\u003e\n\u003cp\u003eIf we need to construct tree with 0 elements, we just return empty tree and list provided to us. Otherwise, we will have tree with one element in root, and subtrees. Size of subtrees will be (n-1) / 2 (remaining amount of elements appriximately equally split for each subtree). First we build left subtree and obtain remaining elements. First of the remaining elements goes into root of our tree, the rest - to building right subtree. After we have both subtrees attached to tree with root element, we return it, and what was left in list of elements from building right subtree.\u003c/p\u003e\n\u003cp\u003eSo, when we have list \u003ccode\u003e(1 3 5 7 9 11)\u003c/code\u003e, we will have following tree:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e(5\n    (1\n        ()\n        (3 () ())\n    )\n    (9\n        (7 () ())\n        (11 () ())\n    )\n)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eb. What is the order of growth in the number of steps required by list-\u003etree to convert a list of n elements?\u003c/p\u003e\n\u003cp\u003epartial-tree is called once for n = 0. For n \u003e 0, it is called X(n), where X(n) = 2 + X( (n-1) / 2) + X(n - 1 - (n-1)/2 = (n-1)/2) =\u003e X(n) = 2 + X((n-1)/2). If X is identity function - equation is true, so X(n) = n. Order of growth is linear.\u003c/p\u003e\n\u003ch2\u003eExercise 2.65\u003c/h2\u003e\n\u003cp\u003eFinally coding and not writing essays. I'm bad at essays (probably need another textbook on this topic, but how to test myself?)\u003c/p\u003e\n\u003cp\u003eI imagine we convert both trees to ordered lists, then use operations on ordered lists described in previous section, then convert back to trees. All of this operations take O(n).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunion-set\u003c/span\u003e s1 s2)\n  (\u003cspan class=\"hljs-name\"\u003elist-\u003etree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elist-union-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etree-\u003elist2\u003c/span\u003e s1) (\u003cspan class=\"hljs-name\"\u003etree-\u003elist2\u003c/span\u003e)))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSame for intersection, just call different function. I'm even not going to test this code, as it will be more effort than writing it.\u003c/p\u003e\n\u003ch2\u003eExercise 2.66\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elookup\u003c/span\u003e given-key set-of-records)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set-of-records) false)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e given-key (\u003cspan class=\"hljs-name\"\u003ekey\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eentry\u003c/span\u003e set-of-records)))\n         (\u003cspan class=\"hljs-name\"\u003eentry\u003c/span\u003e set-of-records))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e given-key (\u003cspan class=\"hljs-name\"\u003ekey\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eentry\u003c/span\u003e set-of-records)))\n         (\u003cspan class=\"hljs-name\"\u003elookup\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e set-of-records)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003elookup\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e set-of-records)))))\u003c/code\u003e\u003c/pre\u003e"},{"id":"sicp2.3.2","title":"SICP 2.3.2 Symbolic differentiation","date":"2020-07-26","tags":["SICP"],"excerpt":"\u003cp\u003eI decided to skip picture language, because of technical reasons. Also, 2.3.1 I'll do in this post, because it was just to short. Here we get one step clother to build interpreter, not yet for programming language, but at least for mathematical expressions.\u003c/p\u003e\n\u003cp\u003eAnd now we are in the \u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-16.html#%25_sec_2.3\"\u003emiddle of second chapter\u003c/a\u003e.\u003c/p\u003e","content":"\u003cp\u003eI decided to skip picture language, because of technical reasons. Also, 2.3.1 I'll do in this post, because it was just to short. Here we get one step clother to build interpreter, not yet for programming language, but at least for mathematical expressions.\u003c/p\u003e\n\u003cp\u003eAnd now we are in the \u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-16.html#%25_sec_2.3\"\u003emiddle of second chapter\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003eExercise 2.54\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e l1 l2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e l1)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e l2)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l2))\n        \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n      )\n      \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e l2)\n      \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e l1 l2) \n    )\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) '(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e '() '())\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'a\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'a\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'a\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'b\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e '(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) '(list \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.55\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003e''abracadabra\u003c/code\u003e is actually a \u003ccode\u003e(quote (quote abracadabra))\u003c/code\u003e which has value \u003ccode\u003e(quote abracadabra)\u003c/code\u003e, and \u003ccode\u003ecar\u003c/code\u003e of it is \u003ccode\u003equote\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003eExercise 2.56\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esymbol?\u003c/span\u003e\u003c/span\u003e x))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e v1 v2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v1) (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v2) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e v1 v2)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e exp num)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e exp num)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e a1 a2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e a1 a2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e a1 a2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e m1 m2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e m1 m2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m1 m2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaddend\u003c/span\u003e s) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e s))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaugend\u003c/span\u003e s) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e s))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplier\u003c/span\u003e p) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e p))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplicand\u003c/span\u003e p) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e p))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponentiation?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebase\u003c/span\u003e e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponent\u003c/span\u003e e) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e e))\n \n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-exponentiation\u003c/span\u003e base e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) base)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e base e))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e exp var)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e exp)\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e exp var) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n        ((\u003cspan class=\"hljs-name\"\u003esum?\u003c/span\u003e exp)\n         (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaddend\u003c/span\u003e exp) var)\n                   (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaugend\u003c/span\u003e exp) var)))\n        ((\u003cspan class=\"hljs-name\"\u003eproduct?\u003c/span\u003e exp)\n         (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e\n           (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplier\u003c/span\u003e exp)\n                         (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplicand\u003c/span\u003e exp) var))\n           (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplier\u003c/span\u003e exp) var)\n                         (\u003cspan class=\"hljs-name\"\u003emultiplicand\u003c/span\u003e exp))))\n        ((\u003cspan class=\"hljs-name\"\u003eexponentiation?\u003c/span\u003e exp)\n         (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponent\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003emake-exponentiation\u003c/span\u003e \n                (\u003cspan class=\"hljs-name\"\u003ebase\u003c/span\u003e exp)\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponent\u003c/span\u003e exp) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n            )))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"unknown expression type -- DERIV\"\u003c/span\u003e exp))))\n\n\n(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(+ (** x \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (** x \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.57\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e a1 a2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e a1 a2))\n        ((\u003cspan class=\"hljs-name\"\u003esum?\u003c/span\u003e a2) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e a1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e a2)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e a1 a2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaddend\u003c/span\u003e s) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e s))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaugend\u003c/span\u003e s) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecdddr\u003c/span\u003e s))\n    (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e s)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e s))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e m1 m2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e m1 m2))\n        ((\u003cspan class=\"hljs-name\"\u003eproduct?\u003c/span\u003e m2) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e m2)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m1 m2))))\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplier\u003c/span\u003e p) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e p))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplicand\u003c/span\u003e s) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecdddr\u003c/span\u003e s))\n    (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e s)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e s))))\n\n(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(+ x (* x x x) (** x \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e;Value 30: (+ 1 (+ (* x (+ x x)) (* x x)) (* 3 (** x 2)))\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.58\u003c/h2\u003e\n\u003cp\u003eSo, we want this to work:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(x + x**2 + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e * x**3) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAt first I wanted to add some parsing step that converts this to lisp, and then reread requirements, and found this: \"Can you design appropriate predicates, selectors, and constructors for this notation such that our derivative program still works?\"\u003c/p\u003e\n\u003cp\u003eSo, no transformation, this should be the format of data, and we need to change functions that work with it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epriority\u003c/span\u003e sym)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e sym \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e sym \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e sym \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e sym) \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e sym) \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e sym) \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"unknown symbol --priority\"\u003c/span\u003e sym))\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e exp)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e op min-pr exp)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e exp)\n            op\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003enp\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epriority\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp))))\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e np min-pr)\n                    (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp) np (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n                    (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e op min-pr (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n                )\n            )\n        )\n    )\n    (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003epriority\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n)\n\n(\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e '(x + x**2 + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e * x**3))\n(\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e '(x * y ** \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e '(y ** \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunwrap\u003c/span\u003e val) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e val) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e val)))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e val)\n        val\n    )\n)\n\n\u003cspan class=\"hljs-comment\"\u003e; Return part of expression before first appearance of given symbol\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e sym exp)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp) sym))\n        '()\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp)\n            (\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n        )\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e '(y ** \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n\n\u003cspan class=\"hljs-comment\"\u003e; Return part of expression after symbol\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; BTW, for division to work properly we need to take last occurence here, but \u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; as we don't have division - I'll leave it with first\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e sym exp)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e exp)\n        '()\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp) sym)\n            (\u003cspan class=\"hljs-name\"\u003eunwrap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n            (\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\n        )\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e '(y ** \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e a1 a2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e a2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) a1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e a2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e a1 a2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e a1 \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e a2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-product\u003c/span\u003e m1 m2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e m1 m2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e m1 \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaddend\u003c/span\u003e s) (\u003cspan class=\"hljs-name\"\u003eunwrap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e s)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaugend\u003c/span\u003e s) (\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e s))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplier\u003c/span\u003e p) (\u003cspan class=\"hljs-name\"\u003eunwrap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e p)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emultiplicand\u003c/span\u003e p) (\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e p))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponentiation?\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleast-priority-operation\u003c/span\u003e x) \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebase\u003c/span\u003e e) (\u003cspan class=\"hljs-name\"\u003eunwrap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebefore\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e e)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eexponent\u003c/span\u003e e) (\u003cspan class=\"hljs-name\"\u003eafter\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e e))\n \n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-exponentiation\u003c/span\u003e base e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) base)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e base \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e e))))\n\n(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(x + x ** \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e * x ** \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis is rather ugly (I don't like \u003ccode\u003ebefore\u003c/code\u003e, \u003ccode\u003eafter\u003c/code\u003e, \u003ccode\u003eunwrap\u003c/code\u003e etc., it does not seem very performant to use them), but I see we will have another example Symbolic Algebra later, maybe there will be a chance to make it better.\u003c/p\u003e"},{"id":"sicp2.2.3","title":"SICP 2.2.3 Sequences as Conventional Interfaces","date":"2020-07-23","tags":["SICP"],"excerpt":"\u003cp\u003eHere we become skilled in list manipulation and build a set of useful subroutines.\u003c/p\u003e","content":"\u003cp\u003eHere we become skilled in list manipulation and build a set of useful subroutines.\u003c/p\u003e\n\u003ch2\u003eExercise 2.33\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op initial sequence)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e sequence)\n      initial\n      (\u003cspan class=\"hljs-name\"\u003eop\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e sequence)\n          (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op initial (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e sequence)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e p sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e x) y)) nil sequence))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e x)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e seq1 seq2)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e cons seq2 seq1))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e y)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e sequence))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.34\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ehorner-eval\u003c/span\u003e x coefficient-sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (this-coeff higher-terms) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e this-coeff (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e higher-terms x)))\n              \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n              coefficient-sequence))\n\n(\u003cspan class=\"hljs-name\"\u003ehorner-eval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n\u003cspan class=\"hljs-comment\"\u003e; 79\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.35\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eidentity\u003c/span\u003e x) x)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-leaves\u003c/span\u003e t)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (head tail)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e head) (\u003cspan class=\"hljs-name\"\u003ecount-leaves\u003c/span\u003e head) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) tail)\n  ) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e identity t)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDon't know why map is here...\u003c/p\u003e\n\u003ch2\u003eExercise 2.36\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e op init seqs)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e seqs))\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op init (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e car seqs))\n            (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e op init (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e cdr seqs)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e s (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e)))\n(\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e s)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.37\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e v w)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e * v w)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematrix-*-vector\u003c/span\u003e m v)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (m-row) (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e m-row v)) m))\n\n(\u003cspan class=\"hljs-name\"\u003ematrix-*-vector\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etranspose\u003c/span\u003e mat)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e cons nil mat))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematrix-*-matrix\u003c/span\u003e m n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ecols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etranspose\u003c/span\u003e n)))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (m-row)\n           (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (n-col)\n                  (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e m-row n-col)\n                )\n            cols\n           )\n         ) m)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.38\u003c/h2\u003e\n\u003cp\u003eI guess, if operation is commutative and associative, then it does not matter which fold to use, otherwise it matters.\u003c/p\u003e\n\u003ch2\u003eExercise 2.39\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003efold-right\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e y (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e x))) nil sequence))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003efold-left\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e y x)) nil sequence))\u003c/code\u003e\u003c/pre\u003e\n\u003ch1\u003eExercise 2.40\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e low high)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e low high)\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e low (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e low \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) high))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e proc seq)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e append nil (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e proc seq)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e n)\n  (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (i)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (j) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e i j)) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))\n  ) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e n))\n)\n(\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e l) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e l)\n    \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l)\n      \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))\n    )\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edivisor?\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eremainder\u003c/span\u003e\u003c/span\u003e n x) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e divisor? (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003etruncate\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))))))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etest-prime\u003c/span\u003e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (n) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e n (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e n))) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003etest-prime\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime-sum-pairs\u003c/span\u003e n)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime-sum?\u003c/span\u003e pair)\n      (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))))\n\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-pair-sum\u003c/span\u003e pair)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e make-pair-sum\n       (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e prime-sum? (\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e n))))\n(\u003cspan class=\"hljs-name\"\u003eprime-sum-pairs\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.41\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e\u003cspan class=\"hljs-comment\"\u003e; 1 \u0026#x3C;= i \u0026#x3C; j \u0026#x3C; k \u0026#x3C;= n\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; i + j + k = s\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etriplets\u003c/span\u003e n s)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebuild-triplet\u003c/span\u003e i j)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ek\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e s i j)))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e j k) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;=\u003c/span\u003e\u003c/span\u003e k n))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e i j k)\n        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (i)\n    (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e pair? (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (j)\n        (\u003cspan class=\"hljs-name\"\u003ebuild-triplet\u003c/span\u003e i j)\n    ) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))))\n    (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n  ))\n(\u003cspan class=\"hljs-name\"\u003etriplets\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.42\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e empty-board (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e)) \u003cspan class=\"hljs-comment\"\u003e; or nil\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-position\u003c/span\u003e new-row k rest-of-queens)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e new-row rest-of-queens)\n)\n\u003cspan class=\"hljs-comment\"\u003e; Check that predicate p(i, elem) is true at least for one of elements of list\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e p l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l i)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e l) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l) i)\n        \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e = (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e = (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e k positions)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n    (\u003cspan class=\"hljs-name\"\u003erow\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions))\n    (\u003cspan class=\"hljs-name\"\u003ed1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n    (\u003cspan class=\"hljs-name\"\u003ed2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n  )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (q i)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e q row)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e d1 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e q i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)) \u003cspan class=\"hljs-comment\"\u003e; i should be increased by 1 because we are in cdr of board\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e d2 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e q i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        )\n    ) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e positions)))\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e board-size)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e k)  \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e empty-board)\n        (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (positions) (\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e k positions))\n         (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (rest-of-queens)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (new-row)\n                   (\u003cspan class=\"hljs-name\"\u003eadjoin-position\u003c/span\u003e new-row k rest-of-queens))\n                 (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e board-size)))\n          (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))))))\n  (\u003cspan class=\"hljs-name\"\u003etrace\u003c/span\u003e queen-cols)\n  (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e board-size))\n(\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-board\u003c/span\u003e positions size)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e n)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ebegin\u003c/span\u003e\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\" .\"\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n      ))\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-row\u003c/span\u003e q)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e q \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\" Q\"\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e size q))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enewline\u003c/span\u003e\u003c/span\u003e)\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003efor-each\u003c/span\u003e\u003c/span\u003e display-row positions)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enewline\u003c/span\u003e\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etest-queens\u003c/span\u003e size)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003efor-each\u003c/span\u003e\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (b) (\u003cspan class=\"hljs-name\"\u003edisplay-board\u003c/span\u003e b size))\n      (\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e size)\n    )\n)\n(\u003cspan class=\"hljs-name\"\u003etest-queens\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e; Beautiful:\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.43\u003c/h2\u003e\n\u003cp\u003eFor size 0 basically running time is the same.\u003c/p\u003e\n\u003cp\u003eFor size 1, we call \u003ccode\u003e(quen-cols 0)\u003c/code\u003e once, check position 1 and return, same for Louis.\u003c/p\u003e\n\u003cp\u003eFor size 2, we call \u003ccode\u003e(queen-cols 1)\u003c/code\u003e once, check positions for next queen 1 and 2, and return. Louis calls (queen-cols 1) twice, because that is inside loop.\u003c/p\u003e\n\u003cp\u003eFor size 3, we call \u003ccode\u003e(queen-cols 2)\u003c/code\u003e once, check positions 1, 2 and 3, and return. Louis calls \u003ccode\u003e(queens-cols 2)\u003c/code\u003e 3 times, each of which calls \u003ccode\u003e(queens-cols 1)\u003c/code\u003e 2 times.\u003c/p\u003e\n\u003cp\u003eSo for us queens-cols is called \u003ccode\u003esize\u003c/code\u003e times, and for Louis \u003ccode\u003e(factorial size)\u003c/code\u003e. If our eight queens runs for time T, then his program will run 8!/8 T = 7! T = 5040T.\u003c/p\u003e"},{"id":"sicp2.2.2","title":"SICP 2.2.2 Hierarchical structures","date":"2020-07-19","tags":["SICP"],"excerpt":"\u003cp\u003eAKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.\u003c/p\u003e\n\u003cp\u003eAlso here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is \"What would interpreter print\", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.\u003c/p\u003e","content":"\u003cp\u003eAKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.\u003c/p\u003e\n\u003cp\u003eAlso here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is \"What would interpreter print\", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.\u003c/p\u003e\n\u003ch2\u003eExercise 2.25\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))))))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))))))))))))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.27\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e x)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edeep-reverse\u003c/span\u003e l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erev-el\u003c/span\u003e el)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e el)\n      (\u003cspan class=\"hljs-name\"\u003edeep-reverse\u003c/span\u003e el)\n      el\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e src dst)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e src)\n      dst\n      (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erev-el\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src)) dst))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l nil)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.28\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003efringe\u003c/span\u003e t)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e src dst)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e src) dst)\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src)) (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src)\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src) nil) dst)\n      ))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src)\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src) dst)\n      ))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e t nil))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.29\u003c/h2\u003e\n\u003cp\u003eConstructors and selectors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e left right))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e mobile))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e mobile)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e length structure)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e length structure))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e branch))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e branch)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTest data:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m1 \n  (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e \n    (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n    (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \n        (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e \n            (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n            (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n        )\n    )\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m2 \n    (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e m1)\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m3\n    (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n    )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e mobile) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e mobile)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)))\n      (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)))\n    )\n    mobile \u003cspan class=\"hljs-comment\"\u003e; if not pair - it should be just weight\u003c/span\u003e\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e mobile)\n  \u003cspan class=\"hljs-comment\"\u003e; weight-b returns weight of mobile if it is balanced, otherwise - negative value\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e mobile)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e mobile)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003elb\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile))))) \u003cspan class=\"hljs-comment\"\u003e; compute left balance\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e lb \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n          \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; left submobile is not balanced, so this mobile too\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003erb\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile))))) \u003cspan class=\"hljs-comment\"\u003e; compute right balance\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e rb \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n              \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; right submobile is not balanced, so this mobile too\u003c/span\u003e\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lb (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)))\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e rb (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)))\n              )\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e lb rb) \u003cspan class=\"hljs-comment\"\u003e; finally, balanced case\u003c/span\u003e\n                \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; submobiles are balanced, but apply different torques in this\u003c/span\u003e\n              )\n            )\n          )\n        )\n      )\n      mobile \u003cspan class=\"hljs-comment\"\u003e; single weight is already balanced by itself\u003c/span\u003e\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e mobile) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m1)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m2)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m3)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWith \u003ccode\u003ebalanced\u003c/code\u003e I was stuck, too many levels of nesting. As usual, I \u003ca href=\"https://stackoverflow.com/questions/62962576/how-to-find-where-scheme-calls-integer-less\"\u003easked on StackOverflow\u003c/a\u003e, went to sleep and in the morning found bug, then someone answered my very obvious question.\u003c/p\u003e\n\u003cp\u003ePart d. If we have such constructors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e left right))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e length structure)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e length structure))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe only have to change such selectors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e mobile))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e branch))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLayers of abstraction are useful (sometimes).\u003c/p\u003e\n\u003ch2\u003eExercise 2.30\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e t) nil)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e t)) (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e t))))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e t))\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e\n (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVersion with map:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e square-tree t)\n    (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e t)\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.31\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e f t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (t) (\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e f t)) t)\n    (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e t)\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.32\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esubsets\u003c/span\u003e s)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e s)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e nil)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003erest\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esubsets\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e s))))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e\n          rest\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (ss) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e s) ss)) rest)\n        ))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eEmtpy set has only one subset - empty. Otherwise each element in the set doubles number of elements in the set of subsets - it creates subsets that are just like subsets without that element, except that they include it.\u003c/p\u003e"},{"id":"sicp2.2.1","title":"SICP 2.2.1 Sequences","date":"2020-07-16","tags":["SICP"],"excerpt":"\u003cp\u003eFinally, the thing Lisp was named after.\u003c/p\u003e\n\u003cp\u003eFix MIT Scheme to be like SICP scheme using this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e nil '())\u003c/code\u003e\u003c/pre\u003e","content":"\u003cp\u003eFinally, the thing Lisp was named after.\u003c/p\u003e\n\u003cp\u003eFix MIT Scheme to be like SICP scheme using this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e nil '())\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.17\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elast-pair\u003c/span\u003e l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))\n    l\n    (\u003cspan class=\"hljs-name\"\u003elast-pair\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003elast-pair\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e23\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e72\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e149\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e34\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.18\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e src dst)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e src)\n      dst\n      (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src) dst))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l nil)\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.19\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e us-coins (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e25\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e uk-coins (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e50\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecc\u003c/span\u003e amount coin-values)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e amount \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e amount \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eno-more?\u003c/span\u003e coin-values)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecc\u003c/span\u003e amount\n                (\u003cspan class=\"hljs-name\"\u003eexcept-first-denomination\u003c/span\u003e coin-values))\n            (\u003cspan class=\"hljs-name\"\u003ecc\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e amount\n                   (\u003cspan class=\"hljs-name\"\u003efirst-denomination\u003c/span\u003e coin-values))\n                coin-values)))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnswer:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e no-more? null?)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e except-first-denomination cdr)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e first-denomination car)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOrder does not matter, because we just sum amount without each element, and with.\u003c/p\u003e\n\u003ch2\u003eExercise 2.20\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-parity\u003c/span\u003e n . l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematches\u003c/span\u003e x) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eremainder\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eremainder\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e l)\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematches\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l) (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l)))\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e n (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.21\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e x x))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-list\u003c/span\u003e items)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e items)\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items)) (\u003cspan class=\"hljs-name\"\u003esquare-list\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-list\u003c/span\u003e items)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e sqr items))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.22\u003c/h2\u003e\n\u003cp\u003eWhat is \u003ccode\u003econs\u003c/code\u003e-ed into list first will be at the end of list.\u003c/p\u003e\n\u003cp\u003eIf we swap arguments to cons, then we will have the same hierarchy (what was consed first is at deepest pair), just link to the next pair is first element of pair, and value is second. To work with such structure properly, we will have to swap  car and cdr.\u003c/p\u003e\n\u003ch2\u003eExercise 2.23\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003efor-each\u003c/span\u003e\u003c/span\u003e f items)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e items)\n    \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e () \u003cspan class=\"hljs-comment\"\u003e; Need some proper way to write blocks of code in if\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003efor-each\u003c/span\u003e\u003c/span\u003e f (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items))\n    ))\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003efor-each\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enewline\u003c/span\u003e\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e x))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e57\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e321\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e88\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e"},{"id":"sicp2.1.4","title":"SICP 2.1.4: Interval arithmetic","date":"2020-07-15","tags":["SICP"],"excerpt":"\u003cp\u003eLess mind-blowing ideas, more practice.\u003c/p\u003e","content":"\u003cp\u003eLess mind-blowing ideas, more practice.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-interval\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y))\n                 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-interval\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ep1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y)))\n        (\u003cspan class=\"hljs-name\"\u003ep2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y)))\n        (\u003cspan class=\"hljs-name\"\u003ep3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y)))\n        (\u003cspan class=\"hljs-name\"\u003ep4\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))))\n    (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emin\u003c/span\u003e\u003c/span\u003e p1 p2 p3 p4)\n                   (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emax\u003c/span\u003e\u003c/span\u003e p1 p2 p3 p4))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003emul-interval\u003c/span\u003e x \n                (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))\n                               (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y)))))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.7\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e a b) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e a b))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emin\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e i)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emax\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e i)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.8\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub-interval\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y))))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.9\u003c/h2\u003e\n\u003cp\u003eLet's have interval (a1,b1) of width w1 = b1 - a1. And similar interval (a2,b2) of width w2 = b2 - a2.\u003c/p\u003e\n\u003cp\u003e(a1,b1) + (a2,b2) = (a1 + a2, b1+b2)\nwidth of this interval is (b1+b2) - (a1+a2) = (b1 - a1) + (b2-a2) = w1+w2\u003c/p\u003e\n\u003cp\u003e(a1,b1) - (a2,b2) = (a1 - b2, b1-a2)\u003c/p\u003e\n\u003cp\u003ewidth of this interval is (b1-a2) - (a1-b2) = b1 - a2 - a1 + b2 = (b1 - a1) + (b2-a2) = w1+w2\u003c/p\u003e\n\u003cp\u003eMultiplication counterexample:\u003c/p\u003e\n\u003cp\u003eLet's multiply two intervals of width 1:\n(1,2) * (1,2) = (1, 3)\nGives interval of width 3.\u003c/p\u003e\n\u003cp\u003eLet's multiply another two intervals of width 1:\n(1,2) * (2,3) = (2, 6)\u003c/p\u003e\n\u003cp\u003eGives interval of width 6. Width of multiplication could not be just function of width of arguments, because it's gives different results for the same inputs. It must be function of something else.\u003c/p\u003e\n\u003ch2\u003eExercise 2.10\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e i) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e i) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e y)\n    (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Could not divide by interval that spans zero\"\u003c/span\u003e)\n    (\u003cspan class=\"hljs-name\"\u003emul-interval\u003c/span\u003e x \n                (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))\n                               (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1.0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y))))\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.11\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erandom-interval\u003c/span\u003e) \n  (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erandom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erandom\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eeq-interval\u003c/span\u003e a b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e b))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e b))\n  )\n)\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etest-mul-interval\u003c/span\u003e) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebad-pair\u003c/span\u003e i1 i2) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Mul-iterval result differs for \"\u003c/span\u003e)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e i1)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edisplay\u003c/span\u003e\u003c/span\u003e i2)\n    \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etry\u003c/span\u003e n)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n            (\u003cspan class=\"hljs-name\"\u003ei1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erandom-interval\u003c/span\u003e))\n            (\u003cspan class=\"hljs-name\"\u003ei2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erandom-interval\u003c/span\u003e))\n        )\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eeq-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-interval2\u003c/span\u003e i1 i2) (\u003cspan class=\"hljs-name\"\u003emul-interval\u003c/span\u003e i1 i2))\n          (\u003cspan class=\"hljs-name\"\u003etry\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)) \n          (\u003cspan class=\"hljs-name\"\u003ebad-pair\u003c/span\u003e i1 i2)\n        )\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003etry\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-interval2\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n    (\u003cspan class=\"hljs-name\"\u003elx\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e x))\n    (\u003cspan class=\"hljs-name\"\u003eux\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e x))\n    (\u003cspan class=\"hljs-name\"\u003ely\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e y))\n    (\u003cspan class=\"hljs-name\"\u003euy\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e y))\n  )\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e ux \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e uy \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux uy) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx ly)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e uy \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx ly)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e lx \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e uy \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx uy)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e ux \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e y))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx uy) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx ly)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e y))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emin\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx uy)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emax\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux uy))))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e lx \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e y))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux uy)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e ux \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e ly \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx uy) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux ly)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003espans-zero\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e ly \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx uy) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux uy)))\n\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e lx \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e ly \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n     (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lx ly) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e ux uy)))\n\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"impossible case\"\u003c/span\u003e))\n  ))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWow this took a lot of effort. Good that they teached to use let, without it secod version of mul-interval would be huge.\u003c/p\u003e\n\u003cp\u003eAnd this required lots of attention, but somehow my code passed the test from the first try.\u003c/p\u003e\n\u003ch2\u003eExercise 2.12\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-center-width\u003c/span\u003e c w)\n  (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e c w) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e c w)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecenter\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e i)) \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ewidth\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eupper-bound\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003elower-bound\u003c/span\u003e i)) \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-center-percent\u003c/span\u003e c p)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ew\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e p \u003cspan class=\"hljs-number\"\u003e0.01\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eabs\u003c/span\u003e\u003c/span\u003e c))))\n  (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e c w) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e c w))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epercent\u003c/span\u003e i)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ewidth\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003ecenter\u003c/span\u003e i)))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.13\u003c/h2\u003e\n\u003cp\u003eIt's approximately addition.\u003c/p\u003e\n\u003ch2\u003eExercise 2.14\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar1\u003c/span\u003e r1 r2)\n  (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-interval\u003c/span\u003e r1 r2)\n                (\u003cspan class=\"hljs-name\"\u003eadd-interval\u003c/span\u003e r1 r2)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar2\u003c/span\u003e r1 r2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eone\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))) \n    (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e one\n                  (\u003cspan class=\"hljs-name\"\u003eadd-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e one r1)\n                                (\u003cspan class=\"hljs-name\"\u003ediv-interval\u003c/span\u003e one r2)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e a (\u003cspan class=\"hljs-name\"\u003emake-center-percent\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e b (\u003cspan class=\"hljs-name\"\u003emake-center-percent\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n\n\n(\u003cspan class=\"hljs-name\"\u003ecenter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar1\u003c/span\u003e a b))\n(\u003cspan class=\"hljs-name\"\u003ecenter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar2\u003c/span\u003e a b))\n\n(\u003cspan class=\"hljs-name\"\u003epercent\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar1\u003c/span\u003e a b))\n(\u003cspan class=\"hljs-name\"\u003epercent\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epar2\u003c/span\u003e a b))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.15\u003c/h2\u003e\n\u003cp\u003eEvery operation on intervals with non zero width increases width of result.\u003c/p\u003e\n\u003cp\u003eIn par1 program does 3 operations in which both intervals have non zero widht, and par2 program does only addition, all the rest are operations with interval of zero widht.\u003c/p\u003e\n\u003ch2\u003eExercise 2.16\u003c/h2\u003e\n\u003cp\u003eNo I can not, because as they said, this problem is very difficult. I imagine it will require simplification of expression to some base form, before computing it.\u003c/p\u003e"},{"id":"sicp2.1.3","title":"SICP 2.1.3 Meaning of data","date":"2020-07-10","tags":["SICP"],"excerpt":"\u003cp\u003eThis section blows your mind by showing that data could be represented by functions. That's kid of obvious that array or assotiative array could be replaced by function that returns value by index, but here you replace with functions even the most basic data type - integer. Not for practical reasons, but I guess to achieve satory about lambda calculus.\u003c/p\u003e","content":"\u003cp\u003eThis section blows your mind by showing that data could be represented by functions. That's kid of obvious that array or assotiative array could be replaced by function that returns value by index, but here you replace with functions even the most basic data type - integer. Not for practical reasons, but I guess to achieve satory about lambda calculus.\u003c/p\u003e\n\u003ch2\u003eExercise 2.4\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (m) (\u003cspan class=\"hljs-name\"\u003em\u003c/span\u003e x y)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e z)\n  (\u003cspan class=\"hljs-name\"\u003ez\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (p q) p)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z)\n  (\u003cspan class=\"hljs-name\"\u003ez\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (p q) q)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.5\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e\u003cspan class=\"hljs-comment\"\u003e; Recursive process and linear time, could be done better\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; but I'm to lazy to copy from previous exercises\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epow\u003c/span\u003e x n) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003epow\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))))\n)\n\n\u003cspan class=\"hljs-comment\"\u003e; iterative linear, not sure if could be made better\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-divisor\u003c/span\u003e x d)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e x count)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eremainder\u003c/span\u003e\u003c/span\u003e x d) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        count\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e/\u003c/span\u003e\u003c/span\u003e x d) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e count \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n      )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x y)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epow\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003epow\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e y))\n) \n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e z)\n  (\u003cspan class=\"hljs-name\"\u003ecount-divisor\u003c/span\u003e z \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z)\n  (\u003cspan class=\"hljs-name\"\u003ecount-divisor\u003c/span\u003e z \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.6\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e zero (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (f) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) x)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einc\u003c/span\u003e n) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (f) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003en\u003c/span\u003e f) x)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e one (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (f) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e x))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e two (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (f) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e x)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eplus\u003c/span\u003e a b)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (f) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) ((\u003cspan class=\"hljs-name\"\u003ea\u003c/span\u003e f) ((\u003cspan class=\"hljs-name\"\u003eb\u003c/span\u003e f) x))))\n)\n\n\u003cspan class=\"hljs-comment\"\u003e; To debug if I placed parentheses correctly :)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003echurch-to-int\u003c/span\u003e n)\n  ((\u003cspan class=\"hljs-name\"\u003en\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n)\n\n(\u003cspan class=\"hljs-name\"\u003echurch-to-int\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eplus\u003c/span\u003e one two))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 3\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere is also nice video from Computerphile that explains how to build Boolean algebra from lambda calculus:\n{{\u0026#x3C; youtube eis11j_iGMs \u003e}}\u003c/p\u003e"}],"pages":2,"archives":[{"url":"/month/2018-12/page/1","id":"2018-12","count":1,"title":"2018-12"},{"url":"/month/2020-06/page/1","id":"2020-06","count":7,"title":"2020-06"},{"url":"/month/2020-07/page/1","id":"2020-07","count":10,"title":"2020-07"},{"url":"/month/2020-08/page/1","id":"2020-08","count":2,"title":"2020-08"},{"url":"/month/2020-09/page/1","id":"2020-09","count":2,"title":"2020-09"},{"url":"/month/2020-12/page/1","id":"2020-12","count":1,"title":"2020-12"},{"url":"/month/2021-01/page/1","id":"2021-01","count":4,"title":"2021-01"}],"topics":[{"url":"/tag/MOOC/page/1","id":"MOOC","title":"MOOC","count":2},{"url":"/tag/SICP/page/1","id":"SICP","title":"SICP","count":20},{"url":"/tag/ideas/page/1","id":"ideas","title":"ideas","count":1},{"url":"/tag/notes/page/1","id":"notes","title":"notes","count":5},{"url":"/tag/on writing/page/1","id":"on writing","title":"on writing","count":3}],"tag":"SICP"},"__N_SSG":true},"page":"/tag/[tag]/page/[page]","query":{"tag":"SICP","page":"1"},"buildId":"ldCo0kqBhAVZTdpBtUtDg","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" async=""></script><script src="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" async=""></script><script src="/_next/static/chunks/commons-131aad2d92e69c360009.js" async=""></script><script src="/_next/static/chunks/main-4f9408d32df08544de44.js" async=""></script><script src="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" async=""></script><script src="/_next/static/chunks/762-bec077d9715dbffe23e5.js" async=""></script><script src="/_next/static/chunks/493-6f47d80e13ed5af25ee4.js" async=""></script><script src="/_next/static/chunks/pages/tag/%5Btag%5D/page/%5Bpage%5D-ca3b8c5356a256900a0e.js" async=""></script><script src="/_next/static/ldCo0kqBhAVZTdpBtUtDg/_buildManifest.js" async=""></script><script src="/_next/static/ldCo0kqBhAVZTdpBtUtDg/_ssgManifest.js" async=""></script></body></html>