<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>SICP 2.2.3 Sequences as Conventional Interfaces</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/b53cc6ef9e9e352d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b53cc6ef9e9e352d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-959cc2ac3c742fb4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b654c501598b6a83.js" defer=""></script><script src="/_next/static/chunks/996-372da0b0d3708a80.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-e5a68c245444f298.js" defer=""></script><script src="/_next/static/uQNCGtV2LdGYQNAen_tCG/_buildManifest.js" defer=""></script><script src="/_next/static/uQNCGtV2LdGYQNAen_tCG/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><h1 id="top">Taras Bunyk</h1><nav><a href="/">Home</a><a href="http://bunyk.github.io/mandala/">Snowflake drawing</a><a href="/resume">Resume</a><a href="/pages/sudoku.html">Sudoku fall</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><article><h1>SICP 2.2.3 Sequences as Conventional Interfaces</h1><div><em>Published: 2020-07-23T18:21:19.000Z</em></div><div><p>Here we become skilled in list manipulation and build a set of useful subroutines.</p>
<h2 id="exercise-233">Exercise 2.33</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">accumulate</span> op initial sequence)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> sequence)
      initial
      (<span class="hljs-name">op</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> sequence)
          (<span class="hljs-name">accumulate</span> op initial (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> sequence)))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">map</span></span> p sequence)
  (<span class="hljs-name">accumulate</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name">p</span> x) y)) nil sequence))

(<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> <span class="hljs-number">1</span> x)) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">append</span></span> seq1 seq2)
  (<span class="hljs-name">accumulate</span> cons seq2 seq1))

(<span class="hljs-name"><span class="hljs-built_in">append</span></span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">4</span> <span class="hljs-number">5</span>))


(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">length</span></span> sequence)
  (<span class="hljs-name">accumulate</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> <span class="hljs-number">1</span> y)) <span class="hljs-number">0</span> sequence))</code></pre>
<h2 id="exercise-234">Exercise 2.34</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">horner-eval</span> x coefficient-sequence)
  (<span class="hljs-name">accumulate</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (this-coeff higher-terms) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> this-coeff (<span class="hljs-name"><span class="hljs-built_in">*</span></span> higher-terms x)))
              <span class="hljs-number">0</span>
              coefficient-sequence))

(<span class="hljs-name">horner-eval</span> <span class="hljs-number">2</span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>))
<span class="hljs-comment">; 79</span></code></pre>
<h2 id="exercise-235">Exercise 2.35</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">identity</span> x) x)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">count-leaves</span> t)
  (<span class="hljs-name">accumulate</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (head tail)
    (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> head) (<span class="hljs-name">count-leaves</span> head) <span class="hljs-number">1</span>) tail)
  ) <span class="hljs-number">0</span> (<span class="hljs-name"><span class="hljs-built_in">map</span></span> identity t)))</code></pre>
<p>Don't know why map is here...</p>
<h2 id="exercise-236">Exercise 2.36</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">accumulate-n</span> op init seqs)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> seqs))
      nil
      (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name">accumulate</span> op init (<span class="hljs-name"><span class="hljs-built_in">map</span></span> car seqs))
            (<span class="hljs-name">accumulate-n</span> op init (<span class="hljs-name"><span class="hljs-built_in">map</span></span> cdr seqs)))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> s (<span class="hljs-name"><span class="hljs-built_in">list</span></span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span>) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span>) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">12</span>)))
(<span class="hljs-name">accumulate-n</span> + <span class="hljs-number">0</span> s)</code></pre>
<h2 id="exercise-237">Exercise 2.37</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">dot-product</span> v w)
  (<span class="hljs-name">accumulate</span> + <span class="hljs-number">0</span> (<span class="hljs-name"><span class="hljs-built_in">map</span></span> * v w)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">matrix-*-vector</span> m v)
  (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (m-row) (<span class="hljs-name">dot-product</span> m-row v)) m))

(<span class="hljs-name">matrix-*-vector</span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">0</span> <span class="hljs-number">-1</span>) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>)) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">transpose</span> mat)
  (<span class="hljs-name">accumulate-n</span> cons nil mat))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">matrix-*-matrix</span> m n)
  (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">cols</span> (<span class="hljs-name">transpose</span> n)))
    (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (m-row)
           (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (n-col)
                  (<span class="hljs-name">dot-product</span> m-row n-col)
                )
            cols
           )
         ) m)))</code></pre>
<h2 id="exercise-238">Exercise 2.38</h2>
<p>I guess, if operation is commutative and associative, then it does not matter which fold to use, otherwise it matters.</p>
<h2 id="exercise-239">Exercise 2.39</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">reverse</span></span> sequence)
  (<span class="hljs-name">fold-right</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name"><span class="hljs-built_in">append</span></span> y (<span class="hljs-name"><span class="hljs-built_in">list</span></span> x))) nil sequence))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">reverse</span></span> sequence)
  (<span class="hljs-name">fold-left</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> y x)) nil sequence))</code></pre>
<h1 id="exercise-240">Exercise 2.40</h1>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">enumerate-interval</span> low high)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> low high)
      nil
      (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> low (<span class="hljs-name">enumerate-interval</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> low <span class="hljs-number">1</span>) high))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">flatmap</span> proc seq)
  (<span class="hljs-name">accumulate</span> append nil (<span class="hljs-name"><span class="hljs-built_in">map</span></span> proc seq)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">unique-pairs</span> n)
  (<span class="hljs-name">flatmap</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (i)
    (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (j) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> i j)) (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">1</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> i <span class="hljs-number">1</span>)))
  ) (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">2</span> n))
)
(<span class="hljs-name">unique-pairs</span> <span class="hljs-number">5</span>)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">any</span> l) 
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> l)
    <span class="hljs-literal">#f</span>
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> l)
      <span class="hljs-literal">#t</span>
      (<span class="hljs-name">any</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> l))
    )
  )
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">prime?</span> n)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">divisor?</span> x) (<span class="hljs-name"><span class="hljs-built_in">=</span></span> (<span class="hljs-name"><span class="hljs-built_in">remainder</span></span> n x) <span class="hljs-number">0</span>))
  (<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name">any</span> (<span class="hljs-name"><span class="hljs-built_in">map</span></span> divisor? (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">2</span> (<span class="hljs-name"><span class="hljs-built_in">truncate</span></span> (<span class="hljs-name"><span class="hljs-built_in">/</span></span> n <span class="hljs-number">2</span>))))))
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">test-prime</span>)
  (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (n) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> n (<span class="hljs-name">prime?</span> n))) (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">1</span> <span class="hljs-number">20</span>))
)
(<span class="hljs-name">test-prime</span>)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">prime-sum-pairs</span> n)
    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">prime-sum?</span> pair)
      (<span class="hljs-name">prime?</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> pair) (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> pair))))

    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-pair-sum</span> pair)
      (<span class="hljs-name"><span class="hljs-built_in">list</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> pair) (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> pair) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> pair) (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> pair))))

  (<span class="hljs-name"><span class="hljs-built_in">map</span></span> make-pair-sum
       (<span class="hljs-name">filter</span> prime-sum? (<span class="hljs-name">unique-pairs</span> n))))
(<span class="hljs-name">prime-sum-pairs</span> <span class="hljs-number">6</span>)</code></pre>
<h2 id="exercise-241">Exercise 2.41</h2>
<pre><code class="hljs language-scheme"><span class="hljs-comment">; 1 &#x3C;= i &#x3C; j &#x3C; k &#x3C;= n</span>
<span class="hljs-comment">; i + j + k = s</span>
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">triplets</span> n s)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">build-triplet</span> i j)
    (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">k</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> s i j)))
      (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">and</span></span> (<span class="hljs-name"><span class="hljs-built_in">&#x3C;</span></span> j k) (<span class="hljs-name"><span class="hljs-built_in">&#x3C;=</span></span> k n))
        (<span class="hljs-name"><span class="hljs-built_in">list</span></span> i j k)
        <span class="hljs-number">0</span>
      )
    )
  )
  (<span class="hljs-name">flatmap</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (i)
    (<span class="hljs-name">filter</span> pair? (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (j)
        (<span class="hljs-name">build-triplet</span> i j)
    ) (<span class="hljs-name">enumerate-interval</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> i <span class="hljs-number">1</span>) (<span class="hljs-name"><span class="hljs-built_in">-</span></span> n <span class="hljs-number">1</span>)))))
    (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">1</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> n <span class="hljs-number">2</span>))
  ))
(<span class="hljs-name">triplets</span> <span class="hljs-number">4</span> <span class="hljs-number">6</span>)</code></pre>
<h2 id="exercise-242">Exercise 2.42</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> empty-board (<span class="hljs-name"><span class="hljs-built_in">list</span></span>)) <span class="hljs-comment">; or nil</span>
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">adjoin-position</span> new-row k rest-of-queens)
  (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> new-row rest-of-queens)
)
<span class="hljs-comment">; Check that predicate p(i, elem) is true at least for one of elements of list</span>
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">any</span> p l)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> l i)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> l) <span class="hljs-literal">#f</span>
      (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name">p</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> l) i)
        <span class="hljs-literal">#t</span>
        (<span class="hljs-name">iter</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> l) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> i <span class="hljs-number">1</span>))
      )
    )
  )
  (<span class="hljs-name">iter</span> l <span class="hljs-number">1</span>)
)
(<span class="hljs-name">any</span> = (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">3</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span>))
(<span class="hljs-name">any</span> = (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">safe?</span> k positions)
  (<span class="hljs-name"><span class="hljs-built_in">let</span></span> (
    (<span class="hljs-name">row</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> positions))
    (<span class="hljs-name">d1</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> positions) <span class="hljs-number">1</span>))
    (<span class="hljs-name">d2</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> positions) <span class="hljs-number">1</span>))
  )
    (<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name">any</span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (q i)
        (<span class="hljs-name"><span class="hljs-built_in">or</span></span> (<span class="hljs-name"><span class="hljs-built_in">=</span></span> q row)
            (<span class="hljs-name"><span class="hljs-built_in">=</span></span> d1 (<span class="hljs-name"><span class="hljs-built_in">+</span></span> q i <span class="hljs-number">1</span>)) <span class="hljs-comment">; i should be increased by 1 because we are in cdr of board</span>
            (<span class="hljs-name"><span class="hljs-built_in">=</span></span> d2 (<span class="hljs-name"><span class="hljs-built_in">-</span></span> q i <span class="hljs-number">1</span>))
        )
    ) (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> positions)))
  )
)
(<span class="hljs-name">safe?</span> <span class="hljs-number">0</span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span>))
(<span class="hljs-name">safe?</span> <span class="hljs-number">0</span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>))
(<span class="hljs-name">safe?</span> <span class="hljs-number">0</span> (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">4</span> <span class="hljs-number">2</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">queens</span> board-size)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">queen-cols</span> k)  
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">=</span></span> k <span class="hljs-number">0</span>)
        (<span class="hljs-name"><span class="hljs-built_in">list</span></span> empty-board)
        (<span class="hljs-name">filter</span>
         (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (positions) (<span class="hljs-name">safe?</span> k positions))
         (<span class="hljs-name">flatmap</span>
          (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (rest-of-queens)
            (<span class="hljs-name"><span class="hljs-built_in">map</span></span> (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (new-row)
                   (<span class="hljs-name">adjoin-position</span> new-row k rest-of-queens))
                 (<span class="hljs-name">enumerate-interval</span> <span class="hljs-number">1</span> board-size)))
          (<span class="hljs-name">queen-cols</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> k <span class="hljs-number">1</span>))))))
  (<span class="hljs-name">trace</span> queen-cols)
  (<span class="hljs-name">queen-cols</span> board-size))
(<span class="hljs-name">queens</span> <span class="hljs-number">6</span>)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">display-board</span> positions size)
    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">display-empty</span> n)
      (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> n <span class="hljs-number">0</span>) (<span class="hljs-name"><span class="hljs-built_in">begin</span></span>
        (<span class="hljs-name"><span class="hljs-built_in">display</span></span> <span class="hljs-string">" ."</span>)
        (<span class="hljs-name">display-empty</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> n <span class="hljs-number">1</span>))
      ))
    )
    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">display-row</span> q)
        (<span class="hljs-name">display-empty</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> q <span class="hljs-number">1</span>))
        (<span class="hljs-name"><span class="hljs-built_in">display</span></span> <span class="hljs-string">" Q"</span>)
        (<span class="hljs-name">display-empty</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> size q))
        (<span class="hljs-name"><span class="hljs-built_in">newline</span></span>)
    )
    (<span class="hljs-name"><span class="hljs-built_in">for-each</span></span> display-row positions)
    (<span class="hljs-name"><span class="hljs-built_in">newline</span></span>)
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">test-queens</span> size)
    (<span class="hljs-name"><span class="hljs-built_in">for-each</span></span>
      (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (b) (<span class="hljs-name">display-board</span> b size))
      (<span class="hljs-name">queens</span> size)
    )
)
(<span class="hljs-name">test-queens</span> <span class="hljs-number">6</span>)

<span class="hljs-comment">; Beautiful:</span>
<span class="hljs-comment">; . . . . Q .</span>
<span class="hljs-comment">; . . Q . . .</span>
<span class="hljs-comment">; Q . . . . .</span>
<span class="hljs-comment">; . . . . . Q</span>
<span class="hljs-comment">; . . . Q . .</span>
<span class="hljs-comment">; . Q . . . .</span>
<span class="hljs-comment">;</span>
<span class="hljs-comment">; . . . Q . .</span>
<span class="hljs-comment">; Q . . . . .</span>
<span class="hljs-comment">; . . . . Q .</span>
<span class="hljs-comment">; . Q . . . .</span>
<span class="hljs-comment">; . . . . . Q</span>
<span class="hljs-comment">; . . Q . . .</span>
<span class="hljs-comment">;</span>
<span class="hljs-comment">; . . Q . . .</span>
<span class="hljs-comment">; . . . . . Q</span>
<span class="hljs-comment">; . Q . . . .</span>
<span class="hljs-comment">; . . . . Q .</span>
<span class="hljs-comment">; Q . . . . .</span>
<span class="hljs-comment">; . . . Q . .</span>
<span class="hljs-comment">;</span>
<span class="hljs-comment">; . Q . . . .</span>
<span class="hljs-comment">; . . . Q . .</span>
<span class="hljs-comment">; . . . . . Q</span>
<span class="hljs-comment">; Q . . . . .</span>
<span class="hljs-comment">; . . Q . . .</span>
<span class="hljs-comment">; . . . . Q .</span></code></pre>
<h2 id="exercise-243">Exercise 2.43</h2>
<p>For size 0 basically running time is the same.</p>
<p>For size 1, we call <code>(quen-cols 0)</code> once, check position 1 and return, same for Louis.</p>
<p>For size 2, we call <code>(queen-cols 1)</code> once, check positions for next queen 1 and 2, and return. Louis calls (queen-cols 1) twice, because that is inside loop.</p>
<p>For size 3, we call <code>(queen-cols 2)</code> once, check positions 1, 2 and 3, and return. Louis calls <code>(queens-cols 2)</code> 3 times, each of which calls <code>(queens-cols 1)</code> 2 times.</p>
<p>So for us queens-cols is called <code>size</code> times, and for Louis <code>(factorial size)</code>. If our eight queens runs for time T, then his program will run 8!/8 T = 7! T = 5040T.</p></div></article><div><div id="disqus_thread"></div></div><nav><a href="/">Home</a><a href="#top">Back to top</a></nav><footer>© <!-- -->2024<!-- --> Bunyk Taras. Built with Next.js</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"sicp2.2.3","title":"SICP 2.2.3 Sequences as Conventional Interfaces","date":"2020-07-23T18:21:19.000Z","tags":["SICP"],"updated_at":"2021-04-20T00:38:16+02:00","content":"\u003cp\u003eHere we become skilled in list manipulation and build a set of useful subroutines.\u003c/p\u003e\n\u003ch2 id=\"exercise-233\"\u003eExercise 2.33\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op initial sequence)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e sequence)\n      initial\n      (\u003cspan class=\"hljs-name\"\u003eop\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e sequence)\n          (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op initial (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e sequence)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e p sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e x) y)) nil sequence))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e x)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eappend\u003c/span\u003e\u003c/span\u003e seq1 seq2)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e cons seq2 seq1))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e))\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elength\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e y)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e sequence))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-234\"\u003eExercise 2.34\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ehorner-eval\u003c/span\u003e x coefficient-sequence)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (this-coeff higher-terms) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e this-coeff (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e higher-terms x)))\n              \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n              coefficient-sequence))\n\n(\u003cspan class=\"hljs-name\"\u003ehorner-eval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n\u003cspan class=\"hljs-comment\"\u003e; 79\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-235\"\u003eExercise 2.35\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eidentity\u003c/span\u003e x) x)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-leaves\u003c/span\u003e t)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (head tail)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e head) (\u003cspan class=\"hljs-name\"\u003ecount-leaves\u003c/span\u003e head) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) tail)\n  ) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e identity t)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDon't know why map is here...\u003c/p\u003e\n\u003ch2 id=\"exercise-236\"\u003eExercise 2.36\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e op init seqs)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e seqs))\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e op init (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e car seqs))\n            (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e op init (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e cdr seqs)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e s (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e11\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e)))\n(\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e s)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-237\"\u003eExercise 2.37\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e v w)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e * v w)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematrix-*-vector\u003c/span\u003e m v)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (m-row) (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e m-row v)) m))\n\n(\u003cspan class=\"hljs-name\"\u003ematrix-*-vector\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etranspose\u003c/span\u003e mat)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate-n\u003c/span\u003e cons nil mat))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ematrix-*-matrix\u003c/span\u003e m n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ecols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etranspose\u003c/span\u003e n)))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (m-row)\n           (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (n-col)\n                  (\u003cspan class=\"hljs-name\"\u003edot-product\u003c/span\u003e m-row n-col)\n                )\n            cols\n           )\n         ) m)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-238\"\u003eExercise 2.38\u003c/h2\u003e\n\u003cp\u003eI guess, if operation is commutative and associative, then it does not matter which fold to use, otherwise it matters.\u003c/p\u003e\n\u003ch2 id=\"exercise-239\"\u003eExercise 2.39\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereverse\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003efold-right\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eappend\u003c/span\u003e\u003c/span\u003e y (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e x))) nil sequence))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereverse\u003c/span\u003e\u003c/span\u003e sequence)\n  (\u003cspan class=\"hljs-name\"\u003efold-left\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e y x)) nil sequence))\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 id=\"exercise-240\"\u003eExercise 2.40\u003c/h1\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e low high)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e low high)\n      nil\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e low (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e low \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) high))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e proc seq)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e append nil (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e proc seq)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e n)\n  (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (i)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (j) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e i j)) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))\n  ) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e n))\n)\n(\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e l) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e l)\n    \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e l)\n      \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))\n    )\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edivisor?\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eremainder\u003c/span\u003e\u003c/span\u003e n x) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e divisor? (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003etruncate\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))))))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etest-prime\u003c/span\u003e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (n) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e n (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e n))) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003etest-prime\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime-sum-pairs\u003c/span\u003e n)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eprime-sum?\u003c/span\u003e pair)\n      (\u003cspan class=\"hljs-name\"\u003eprime?\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))))\n\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-pair-sum\u003c/span\u003e pair)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e make-pair-sum\n       (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e prime-sum? (\u003cspan class=\"hljs-name\"\u003eunique-pairs\u003c/span\u003e n))))\n(\u003cspan class=\"hljs-name\"\u003eprime-sum-pairs\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-241\"\u003eExercise 2.41\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e\u003cspan class=\"hljs-comment\"\u003e; 1 \u0026#x3C;= i \u0026#x3C; j \u0026#x3C; k \u0026#x3C;= n\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; i + j + k = s\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etriplets\u003c/span\u003e n s)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebuild-triplet\u003c/span\u003e i j)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003ek\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e s i j)))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e j k) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u0026#x3C;=\u003c/span\u003e\u003c/span\u003e k n))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e i j k)\n        \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (i)\n    (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e pair? (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (j)\n        (\u003cspan class=\"hljs-name\"\u003ebuild-triplet\u003c/span\u003e i j)\n    ) (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))))\n    (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n  ))\n(\u003cspan class=\"hljs-name\"\u003etriplets\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-242\"\u003eExercise 2.42\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e empty-board (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e)) \u003cspan class=\"hljs-comment\"\u003e; or nil\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-position\u003c/span\u003e new-row k rest-of-queens)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e new-row rest-of-queens)\n)\n\u003cspan class=\"hljs-comment\"\u003e; Check that predicate p(i, elem) is true at least for one of elements of list\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e p l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l i)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e l) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e l) i)\n        \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e = (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e = (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e k positions)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n    (\u003cspan class=\"hljs-name\"\u003erow\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions))\n    (\u003cspan class=\"hljs-name\"\u003ed1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n    (\u003cspan class=\"hljs-name\"\u003ed2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e positions) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n  )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eany\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (q i)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e q row)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e d1 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e q i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)) \u003cspan class=\"hljs-comment\"\u003e; i should be increased by 1 because we are in cdr of board\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e d2 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e q i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        )\n    ) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e positions)))\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e board-size)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e k)  \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e empty-board)\n        (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (positions) (\u003cspan class=\"hljs-name\"\u003esafe?\u003c/span\u003e k positions))\n         (\u003cspan class=\"hljs-name\"\u003eflatmap\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (rest-of-queens)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (new-row)\n                   (\u003cspan class=\"hljs-name\"\u003eadjoin-position\u003c/span\u003e new-row k rest-of-queens))\n                 (\u003cspan class=\"hljs-name\"\u003eenumerate-interval\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e board-size)))\n          (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))))))\n  (\u003cspan class=\"hljs-name\"\u003etrace\u003c/span\u003e queen-cols)\n  (\u003cspan class=\"hljs-name\"\u003equeen-cols\u003c/span\u003e board-size))\n(\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-board\u003c/span\u003e positions size)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e n)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edisplay\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\" .\"\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e n \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n      ))\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edisplay-row\u003c/span\u003e q)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e q \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edisplay\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\" Q\"\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003edisplay-empty\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e size q))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enewline\u003c/span\u003e\u003c/span\u003e)\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003efor-each\u003c/span\u003e\u003c/span\u003e display-row positions)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enewline\u003c/span\u003e\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etest-queens\u003c/span\u003e size)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003efor-each\u003c/span\u003e\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (b) (\u003cspan class=\"hljs-name\"\u003edisplay-board\u003c/span\u003e b size))\n      (\u003cspan class=\"hljs-name\"\u003equeens\u003c/span\u003e size)\n    )\n)\n(\u003cspan class=\"hljs-name\"\u003etest-queens\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e; Beautiful:\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . Q . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . Q . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . . Q\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; Q . . . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . Q . . .\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e; . . . . Q .\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-243\"\u003eExercise 2.43\u003c/h2\u003e\n\u003cp\u003eFor size 0 basically running time is the same.\u003c/p\u003e\n\u003cp\u003eFor size 1, we call \u003ccode\u003e(quen-cols 0)\u003c/code\u003e once, check position 1 and return, same for Louis.\u003c/p\u003e\n\u003cp\u003eFor size 2, we call \u003ccode\u003e(queen-cols 1)\u003c/code\u003e once, check positions for next queen 1 and 2, and return. Louis calls (queen-cols 1) twice, because that is inside loop.\u003c/p\u003e\n\u003cp\u003eFor size 3, we call \u003ccode\u003e(queen-cols 2)\u003c/code\u003e once, check positions 1, 2 and 3, and return. Louis calls \u003ccode\u003e(queens-cols 2)\u003c/code\u003e 3 times, each of which calls \u003ccode\u003e(queens-cols 1)\u003c/code\u003e 2 times.\u003c/p\u003e\n\u003cp\u003eSo for us queens-cols is called \u003ccode\u003esize\u003c/code\u003e times, and for Louis \u003ccode\u003e(factorial size)\u003c/code\u003e. If our eight queens runs for time T, then his program will run 8!/8 T = 7! T = 5040T.\u003c/p\u003e"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.2.3"},"buildId":"uQNCGtV2LdGYQNAen_tCG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>