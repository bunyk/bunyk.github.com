<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>SICP3.3.1 Mutable list structure</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/b53cc6ef9e9e352d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b53cc6ef9e9e352d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-959cc2ac3c742fb4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ec0fdebf93e8fc69.js" defer=""></script><script src="/_next/static/chunks/996-372da0b0d3708a80.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-959ba1136e063a38.js" defer=""></script><script src="/_next/static/sW-wDccd-ZCyzGzfnKrfa/_buildManifest.js" defer=""></script><script src="/_next/static/sW-wDccd-ZCyzGzfnKrfa/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><h1 id="top">Taras Bunyk</h1><nav><a href="/">Home</a><a href="http://bunyk.github.io/mandala/">Snowflake drawing</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><article><h1>SICP3.3.1 Mutable list structure</h1><div><em>Published: 2022-10-31T17:19:37.000Z</em></div><div><p>This chapter seems to be not about state itself, but about the weird recursive data structures that you could have when you have assignment. Like lists that contain themselves. Could you build such list without mutation? Well, I don't think so, because to add a list to a list, you should already have a list you add. And you could not do that with just one <code>cons</code>.</p>
<p>You could think that I skipped section 3.2. I did not, but exercises there do not ask to write code, just draw some diagrams or guess output. You don't want to look at that scribbles, because they look like this:</p>
<h2 id="exercise-315">Exercise 3.15</h2>
<p><img src="/content/sicp-scribble-337.png" alt="My scribbles" title="My Scheme environment scribbles"></p>
<h3 id="exercise-316">Exercise 3.16</h3>
<p>Having this procedure to count pairs in list:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">count-pairs</span> x)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> x))
	<span class="hljs-number">0</span>
	(<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">count-pairs</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> x))
	   (<span class="hljs-name">count-pairs</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> x))
	   <span class="hljs-number">1</span>)))</code></pre>
<p>p3, p4, p7 and p3 again are structures made exactly from 3 pairs for which this function returns
3, 4, 7 pairs and maximum recursion depth errors respectively.</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p3 (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>))
p<span class="hljs-number">3</span> <span class="hljs-comment">; (1 2 3)</span>
(<span class="hljs-name">count-pairs</span> p3)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> c (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">3</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p4 (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> c (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">2</span> c)))
p<span class="hljs-number">4</span> <span class="hljs-comment">; ((3) 2 3)</span>
(<span class="hljs-name">count-pairs</span> p4)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> a (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> b (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> a a))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p7 (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> b b))
p<span class="hljs-number">7</span><span class="hljs-comment">; (((1) 1) (1) 1)</span>
(<span class="hljs-name">count-pairs</span> p7)

(<span class="hljs-name"><span class="hljs-built_in">set-cdr!</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> p3)) p3)
p<span class="hljs-number">3</span>
(<span class="hljs-name">count-pairs</span> p3) <span class="hljs-comment">; Aborting!: maximum recursion depth exceeded</span></code></pre>
<h3 id="exercise-317">Exercise 3.17</h3>
<p>Correct <code>count-pairs</code>. Returns 3 for all the tests in previous exercise.</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">new-set</span>)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> items '())

  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">in</span> el items) 
	(<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> items)
	  false
	  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> items) el)
		true
		(<span class="hljs-name">in</span> el (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> items)))))

  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">add</span> el)
	(<span class="hljs-name"><span class="hljs-built_in">set!</span></span> items (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> el items)))

  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">dispatch</span> m)
	(<span class="hljs-name"><span class="hljs-built_in">cond</span></span> 
	  ((<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> m <span class="hljs-symbol">'add</span>) add)
	  ((<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> m <span class="hljs-symbol">'in</span>) (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (el) (<span class="hljs-name">in</span> el items)))
	  ((<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> m <span class="hljs-symbol">'as-list</span>) items)))

  dispatch)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">in-set?</span> set el)
  ((<span class="hljs-name">set</span> <span class="hljs-symbol">'in</span>) el))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">add-to-set</span> set el)
  ((<span class="hljs-name">set</span> <span class="hljs-symbol">'add</span>) el))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">as-list</span> set)
  (<span class="hljs-name">set</span> <span class="hljs-symbol">'as-list</span>))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> ts (<span class="hljs-name">new-set</span>))<span class="hljs-comment">; test set</span>
(<span class="hljs-name">as-list</span> ts)
(<span class="hljs-name">add-to-set</span> ts <span class="hljs-number">1</span>)
(<span class="hljs-name">as-list</span> ts)
(<span class="hljs-name">add-to-set</span> ts <span class="hljs-number">2</span>)
(<span class="hljs-name">as-list</span> ts)
(<span class="hljs-name">in-set?</span> ts <span class="hljs-number">1</span>)
(<span class="hljs-name">in-set?</span> ts <span class="hljs-number">3</span>)
(<span class="hljs-name">add-to-set</span> ts <span class="hljs-number">3</span>)
(<span class="hljs-name">as-list</span> ts)
(<span class="hljs-name">in-set?</span> ts <span class="hljs-number">3</span>)


(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">count-pairs</span> x)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> counted (<span class="hljs-name">new-set</span>))

  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">count-uncounted</span> x)
	(<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">or</span></span> (<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> x)) (<span class="hljs-name">in-set?</span> counted x))
	  <span class="hljs-number">0</span>
	  (<span class="hljs-name"><span class="hljs-built_in">begin</span></span>
		(<span class="hljs-name">add-to-set</span> counted x)
		(<span class="hljs-name"><span class="hljs-built_in">+</span></span> <span class="hljs-number">1</span>
		   (<span class="hljs-name">count-uncounted</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> x))
		   (<span class="hljs-name">count-uncounted</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> x))
		)
	  )
	)
  )

  (<span class="hljs-name">count-uncounted</span> x)
)</code></pre>
<h3 id="exercise-318">Exercise 3.18</h3>
<p>Detect a cycle in list. It says the only one that makes interation with <code>cdr</code> to go into infinite loop, but it's not very hard to make one that finds loops in whole graph of pairs.</p>
<p>Wikipedia on cycles:</p>
<blockquote>
<p>The existence of a cycle in directed and undirected graphs can be determined by whether depth-first search (DFS) finds an edge that points to an ancestor of the current vertex (it contains a back edge).</p>
</blockquote>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">in-list?</span> l el) 
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span> 
	((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> l) false)
	((<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> el (<span class="hljs-name"><span class="hljs-built_in">car</span></span> l)) true)
	(<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">in-list?</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> l) el))
  )
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">has-cycle?</span> l) 
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">visit</span> node path)
	(<span class="hljs-name"><span class="hljs-built_in">cond</span></span> 
	  ((<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> node)) false)<span class="hljs-comment">; Finished DFS in this subtree</span>
	  ((<span class="hljs-name">in-list?</span> path node) true) <span class="hljs-comment">; Found back edge</span>
	  (<span class="hljs-name"><span class="hljs-built_in">else</span></span> 
		(<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">new-path</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> node path))) <span class="hljs-comment">; visit from this node</span>
		  (<span class="hljs-name"><span class="hljs-built_in">or</span></span>
			(<span class="hljs-name">visit</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> node) new-path) <span class="hljs-comment">; check for loops in car</span>
			(<span class="hljs-name">visit</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> node) new-path) <span class="hljs-comment">; check for loops in cdr</span>
		  )
		)
	  )
	)
  )
  <span class="hljs-comment">; (trace visit)</span>
  (<span class="hljs-name">visit</span> l '())
)

<span class="hljs-comment">; FROM PREVIOUS EXERCISE</span>
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p3 (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>))
p<span class="hljs-number">3</span> <span class="hljs-comment">; (1 2 3)</span>
(<span class="hljs-name">has-cycle?</span> p3)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> c (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">3</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p4 (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> c (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">2</span> c)))
p<span class="hljs-number">4</span> <span class="hljs-comment">; ((3) 2 3)</span>
(<span class="hljs-name">has-cycle?</span> p4)

(<span class="hljs-name"><span class="hljs-built_in">set-cdr!</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> p3)) p3)
p<span class="hljs-number">3</span>
(<span class="hljs-name">has-cycle?</span> p3)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p1 (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>))
(<span class="hljs-name"><span class="hljs-built_in">set-car!</span></span> p1 p1)
p<span class="hljs-number">1</span>
(<span class="hljs-name">has-cycle?</span> p1)</code></pre>
<h3 id="exescise-319">Exescise 3.19</h3>
<p>Redo Exescise 3.18 using an algorighm that takes only a constant amount of space. (This requires a very clever idea.).</p>
<p>I know which idea, but for for this idea to work, we need to stick to definition of loop from 3.18, view the list only as a list that could loop on the end, not a graph of pairs.</p>
<p>I know this idea because of <a href="https://www.youtube.com/watch?v=pKO9UjSeLew">video "If Programming Was An Anime"</a>.</p>
<blockquote>
<p>This question is ...</p>
<p>trivial</p>
<p>Solving this in linear time and constant space requires Floyd's Tortoise and Hare</p>
</blockquote>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">has-cycle?</span> l) 
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> tortoise hare)
	(<span class="hljs-name"><span class="hljs-built_in">cond</span></span>
	  ((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> hare) false) <span class="hljs-comment">; hare reached finish, there is no loop</span>
	  ((<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> tortoise hare) true) <span class="hljs-comment">; loop race finished, there is a loop</span>
	  ((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> hare)) false) <span class="hljs-comment">; hare reached finish</span>
	  (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">iter</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> tortoise) (<span class="hljs-name">cddr</span> hare))) <span class="hljs-comment">; continue race</span>
	)
  )
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span>  <span class="hljs-comment">; first, handle some edge cases</span>
	((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> l) false) <span class="hljs-comment">; empty lists have no cycles</span>
	((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> l)) false) <span class="hljs-comment">; one-element lists have no cycles</span>
  	(<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">iter</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> l) (<span class="hljs-name">cddr</span> l))) <span class="hljs-comment">; start the race</span>
  )
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p1 (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span>))
(<span class="hljs-name">has-cycle?</span> p1)
(<span class="hljs-name"><span class="hljs-built_in">set-cdr!</span></span> p1 p1)
p<span class="hljs-number">1</span>
(<span class="hljs-name">has-cycle?</span> p1)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> p3 (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span>))
p<span class="hljs-number">3</span>
(<span class="hljs-name">has-cycle?</span> p3)

(<span class="hljs-name"><span class="hljs-built_in">set-cdr!</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> p3)) p3)
p<span class="hljs-number">3</span>
(<span class="hljs-name">has-cycle?</span> p3)</code></pre></div></article><div><div id="disqus_thread"></div></div><nav><a href="/">Home</a><a href="#top">Back to top</a></nav><footer>Â© <!-- -->2022<!-- --> Bunyk Taras. Built with Next.js</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"sicp3.3.1","title":"SICP3.3.1 Mutable list structure","date":"2022-10-31T17:19:37.000Z","tags":["SICP"],"updated_at":"","content":"\u003cp\u003eThis chapter seems to be not about state itself, but about the weird recursive data structures that you could have when you have assignment. Like lists that contain themselves. Could you build such list without mutation? Well, I don't think so, because to add a list to a list, you should already have a list you add. And you could not do that with just one \u003ccode\u003econs\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eYou could think that I skipped section 3.2. I did not, but exercises there do not ask to write code, just draw some diagrams or guess output. You don't want to look at that scribbles, because they look like this:\u003c/p\u003e\n\u003ch2 id=\"exercise-315\"\u003eExercise 3.15\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"/content/sicp-scribble-337.png\" alt=\"My scribbles\" title=\"My Scheme environment scribbles\"\u003e\u003c/p\u003e\n\u003ch3 id=\"exercise-316\"\u003eExercise 3.16\u003c/h3\u003e\n\u003cp\u003eHaving this procedure to count pairs in list:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e x))\n\t\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e x))\n\t   (\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e x))\n\t   \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ep3, p4, p7 and p3 again are structures made exactly from 3 pairs for which this function returns\n3, 4, 7 pairs and maximum recursion depth errors respectively.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p3 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; (1 2 3)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e p3)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e c (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p4 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e c (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e c)))\np\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; ((3) 2 3)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e p4)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e a (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e b (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e a a))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p7 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e b b))\np\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e; (((1) 1) (1) 1)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e p7)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset-cdr!\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e p3)) p3)\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e p3) \u003cspan class=\"hljs-comment\"\u003e; Aborting!: maximum recursion depth exceeded\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"exercise-317\"\u003eExercise 3.17\u003c/h3\u003e\n\u003cp\u003eCorrect \u003ccode\u003ecount-pairs\u003c/code\u003e. Returns 3 for all the tests in previous exercise.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enew-set\u003c/span\u003e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e items '())\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ein\u003c/span\u003e el items) \n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e items)\n\t  false\n\t  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) el)\n\t\ttrue\n\t\t(\u003cspan class=\"hljs-name\"\u003ein\u003c/span\u003e el (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items)))))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd\u003c/span\u003e el)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset!\u003c/span\u003e\u003c/span\u003e items (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e el items)))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edispatch\u003c/span\u003e m)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e \n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e m \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e) add)\n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e m \u003cspan class=\"hljs-symbol\"\u003e'in\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (el) (\u003cspan class=\"hljs-name\"\u003ein\u003c/span\u003e el items)))\n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e m \u003cspan class=\"hljs-symbol\"\u003e'as-list\u003c/span\u003e) items)))\n\n  dispatch)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ein-set?\u003c/span\u003e set el)\n  ((\u003cspan class=\"hljs-name\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'in\u003c/span\u003e) el))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-to-set\u003c/span\u003e set el)\n  ((\u003cspan class=\"hljs-name\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e) el))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eas-list\u003c/span\u003e set)\n  (\u003cspan class=\"hljs-name\"\u003eset\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'as-list\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e ts (\u003cspan class=\"hljs-name\"\u003enew-set\u003c/span\u003e))\u003cspan class=\"hljs-comment\"\u003e; test set\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003eas-list\u003c/span\u003e ts)\n(\u003cspan class=\"hljs-name\"\u003eadd-to-set\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003eas-list\u003c/span\u003e ts)\n(\u003cspan class=\"hljs-name\"\u003eadd-to-set\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003eas-list\u003c/span\u003e ts)\n(\u003cspan class=\"hljs-name\"\u003ein-set?\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003ein-set?\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003eadd-to-set\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003eas-list\u003c/span\u003e ts)\n(\u003cspan class=\"hljs-name\"\u003ein-set?\u003c/span\u003e ts \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-pairs\u003c/span\u003e x)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e counted (\u003cspan class=\"hljs-name\"\u003enew-set\u003c/span\u003e))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecount-uncounted\u003c/span\u003e x)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e x)) (\u003cspan class=\"hljs-name\"\u003ein-set?\u003c/span\u003e counted x))\n\t  \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n\t  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e\u003c/span\u003e\n\t\t(\u003cspan class=\"hljs-name\"\u003eadd-to-set\u003c/span\u003e counted x)\n\t\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\t\t   (\u003cspan class=\"hljs-name\"\u003ecount-uncounted\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e x))\n\t\t   (\u003cspan class=\"hljs-name\"\u003ecount-uncounted\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e x))\n\t\t)\n\t  )\n\t)\n  )\n\n  (\u003cspan class=\"hljs-name\"\u003ecount-uncounted\u003c/span\u003e x)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"exercise-318\"\u003eExercise 3.18\u003c/h3\u003e\n\u003cp\u003eDetect a cycle in list. It says the only one that makes interation with \u003ccode\u003ecdr\u003c/code\u003e to go into infinite loop, but it's not very hard to make one that finds loops in whole graph of pairs.\u003c/p\u003e\n\u003cp\u003eWikipedia on cycles:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe existence of a cycle in directed and undirected graphs can be determined by whether depth-first search (DFS) finds an edge that points to an ancestor of the current vertex (it contains a back edge).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ein-list?\u003c/span\u003e l el) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e \n\t((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e l) false)\n\t((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e el (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e l)) true)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ein-list?\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l) el))\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e l) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003evisit\u003c/span\u003e node path)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e \n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e node)) false)\u003cspan class=\"hljs-comment\"\u003e; Finished DFS in this subtree\u003c/span\u003e\n\t  ((\u003cspan class=\"hljs-name\"\u003ein-list?\u003c/span\u003e path node) true) \u003cspan class=\"hljs-comment\"\u003e; Found back edge\u003c/span\u003e\n\t  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e \n\t\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003enew-path\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e node path))) \u003cspan class=\"hljs-comment\"\u003e; visit from this node\u003c/span\u003e\n\t\t  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eor\u003c/span\u003e\u003c/span\u003e\n\t\t\t(\u003cspan class=\"hljs-name\"\u003evisit\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e node) new-path) \u003cspan class=\"hljs-comment\"\u003e; check for loops in car\u003c/span\u003e\n\t\t\t(\u003cspan class=\"hljs-name\"\u003evisit\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e node) new-path) \u003cspan class=\"hljs-comment\"\u003e; check for loops in cdr\u003c/span\u003e\n\t\t  )\n\t\t)\n\t  )\n\t)\n  )\n  \u003cspan class=\"hljs-comment\"\u003e; (trace visit)\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003evisit\u003c/span\u003e l '())\n)\n\n\u003cspan class=\"hljs-comment\"\u003e; FROM PREVIOUS EXERCISE\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p3 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; (1 2 3)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p3)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e c (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p4 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e c (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e c)))\np\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; ((3) 2 3)\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p4)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset-cdr!\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e p3)) p3)\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p3)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p1 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset-car!\u003c/span\u003e\u003c/span\u003e p1 p1)\np\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p1)\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"exescise-319\"\u003eExescise 3.19\u003c/h3\u003e\n\u003cp\u003eRedo Exescise 3.18 using an algorighm that takes only a constant amount of space. (This requires a very clever idea.).\u003c/p\u003e\n\u003cp\u003eI know which idea, but for for this idea to work, we need to stick to definition of loop from 3.18, view the list only as a list that could loop on the end, not a graph of pairs.\u003c/p\u003e\n\u003cp\u003eI know this idea because of \u003ca href=\"https://www.youtube.com/watch?v=pKO9UjSeLew\"\u003evideo \"If Programming Was An Anime\"\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis question is ...\u003c/p\u003e\n\u003cp\u003etrivial\u003c/p\u003e\n\u003cp\u003eSolving this in linear time and constant space requires Floyd's Tortoise and Hare\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e l) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e tortoise hare)\n\t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e\n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e hare) false) \u003cspan class=\"hljs-comment\"\u003e; hare reached finish, there is no loop\u003c/span\u003e\n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e tortoise hare) true) \u003cspan class=\"hljs-comment\"\u003e; loop race finished, there is a loop\u003c/span\u003e\n\t  ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e hare)) false) \u003cspan class=\"hljs-comment\"\u003e; hare reached finish\u003c/span\u003e\n\t  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e tortoise) (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e hare))) \u003cspan class=\"hljs-comment\"\u003e; continue race\u003c/span\u003e\n\t)\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e  \u003cspan class=\"hljs-comment\"\u003e; first, handle some edge cases\u003c/span\u003e\n\t((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e l) false) \u003cspan class=\"hljs-comment\"\u003e; empty lists have no cycles\u003c/span\u003e\n\t((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l)) false) \u003cspan class=\"hljs-comment\"\u003e; one-element lists have no cycles\u003c/span\u003e\n  \t(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l) (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e l))) \u003cspan class=\"hljs-comment\"\u003e; start the race\u003c/span\u003e\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p1 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p1)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset-cdr!\u003c/span\u003e\u003c/span\u003e p1 p1)\np\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p1)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e p3 (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p3)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eset-cdr!\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e p3)) p3)\np\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003ehas-cycle?\u003c/span\u003e p3)\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp3.3.1"},"buildId":"sW-wDccd-ZCyzGzfnKrfa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>