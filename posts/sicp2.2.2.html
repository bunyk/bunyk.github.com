<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>SICP 2.2.2 Hierarchical structures</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/f969c0c492dd18a0081f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f969c0c492dd18a0081f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-fb76148cfcfb42ca18eb.js" defer=""></script><script src="/_next/static/chunks/framework-2191d16384373197bc0a.js" defer=""></script><script src="/_next/static/chunks/main-89e612c37cd79392e22d.js" defer=""></script><script src="/_next/static/chunks/pages/_app-459ac92bde4bcd5c6050.js" defer=""></script><script src="/_next/static/chunks/762-0f685813c4b6ace6d024.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-c7e99dccd451c876ca34.js" defer=""></script><script src="/_next/static/lrc2VRTLiTq1Qkc5KeKdA/_buildManifest.js" defer=""></script><script src="/_next/static/lrc2VRTLiTq1Qkc5KeKdA/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="MuiContainer-root MuiContainer-maxWidthMd"><div class="MuiToolbar-root MuiToolbar-regular jss2 MuiToolbar-gutters"><h1 class="MuiTypography-root jss3 MuiTypography-h5 MuiTypography-noWrap" aligh="center">Taras Bunyk</h1></div><nav class="MuiToolbar-root MuiToolbar-dense jss4 MuiToolbar-gutters"><a href="/">Home</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-5"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-9"><div class="MuiPaper-root MuiCard-root MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.2.2 Hierarchical structures</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-07-19 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>AKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.</p>
<p>Also here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is "What would interpreter print", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.</p>
<h2>Exercise 2.25</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> l (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">3</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">5</span> <span class="hljs-number">7</span>) <span class="hljs-number">9</span>))
l
(<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> l)))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> l (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">7</span>)))
l
(<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> l))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> l (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">1</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">2</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">3</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">4</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">5</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>)))))))
l
(<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> l))))))))))))</code></pre>
<h2>Exercise 2.27</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> x (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">1</span> <span class="hljs-number">2</span>) (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>)))
(<span class="hljs-name"><span class="hljs-builtin-name">reverse</span></span> x)

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">deep-reverse</span> l)
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">rev-el</span> el)
    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> el)
      (<span class="hljs-name">deep-reverse</span> el)
      el
    )
  )
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">iter</span> src dst)
    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> src)
      dst
      (<span class="hljs-name">iter</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> src) (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name">rev-el</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> src)) dst))
    )
  )
  (<span class="hljs-name">iter</span> l nil)
)</code></pre>
<h2>Exercise 2.28</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">fringe</span> t)
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">iter</span> src dst)
    (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span>
      ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> src) dst)
      ((<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> src)) (<span class="hljs-name">iter</span>
         (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> src)
         (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">iter</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> src) nil) dst)
      ))
      (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name">iter</span>
          (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> src)
          (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> src) dst)
      ))
    )
  )
  (<span class="hljs-name"><span class="hljs-builtin-name">reverse</span></span> (<span class="hljs-name">iter</span> t nil))
)</code></pre>
<h2>Exercise 2.29</h2>
<p>Constructors and selectors:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-mobile</span> left right)
  (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> left right))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">left-branch</span> mobile)
  (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> mobile))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">right-branch</span> mobile)
  (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> mobile)))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-branch</span> length structure)
  (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> length structure))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">branch-length</span> branch)
  (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> branch))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">branch-structure</span> branch)
  (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> branch)))</code></pre>
<p>Test data:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> m1 
  (<span class="hljs-name">make-mobile</span> 
    (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> <span class="hljs-number">10</span>)
    (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> 
        (<span class="hljs-name">make-mobile</span> 
            (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> <span class="hljs-number">5</span>)
            (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> <span class="hljs-number">5</span>)
        )
    )
  )
)
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> m2 
    (<span class="hljs-name">make-mobile</span>
        (<span class="hljs-name">make-branch</span> <span class="hljs-number">2</span> <span class="hljs-number">10</span>)
        (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> m1)
    )
)

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> m3
    (<span class="hljs-name">make-mobile</span>
        (<span class="hljs-name">make-branch</span> <span class="hljs-number">2</span> <span class="hljs-number">10</span>)
        (<span class="hljs-name">make-branch</span> <span class="hljs-number">1</span> <span class="hljs-number">10</span>)
    )
)</code></pre>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">total-weight</span> mobile) 
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> mobile)
    (<span class="hljs-name"><span class="hljs-builtin-name">+</span></span>
      (<span class="hljs-name">total-weight</span> (<span class="hljs-name">branch-structure</span> (<span class="hljs-name">left-branch</span> mobile)))
      (<span class="hljs-name">total-weight</span> (<span class="hljs-name">branch-structure</span> (<span class="hljs-name">right-branch</span> mobile)))
    )
    mobile <span class="hljs-comment">; if not pair - it should be just weight</span>
  )
)

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">balanced</span> mobile)
  <span class="hljs-comment">; weight-b returns weight of mobile if it is balanced, otherwise - negative value</span>
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">weight-b</span> mobile)
    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> mobile)
      (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">lb</span> (<span class="hljs-name">weight-b</span> (<span class="hljs-name">branch-structure</span> (<span class="hljs-name">left-branch</span> mobile))))) <span class="hljs-comment">; compute left balance</span>
        (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">&#x3C;</span></span> lb <span class="hljs-number">0</span>)
          <span class="hljs-number">-1</span> <span class="hljs-comment">; left submobile is not balanced, so this mobile too</span>
          (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">rb</span> (<span class="hljs-name">weight-b</span> (<span class="hljs-name">branch-structure</span> (<span class="hljs-name">right-branch</span> mobile))))) <span class="hljs-comment">; compute right balance</span>
            (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">&#x3C;</span></span> rb <span class="hljs-number">0</span>)
              <span class="hljs-number">-1</span> <span class="hljs-comment">; right submobile is not balanced, so this mobile too</span>
              (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span>
                (<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> lb (<span class="hljs-name">branch-length</span> (<span class="hljs-name">left-branch</span> mobile)))
                (<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> rb (<span class="hljs-name">branch-length</span> (<span class="hljs-name">right-branch</span> mobile)))
              )
                (<span class="hljs-name"><span class="hljs-builtin-name">+</span></span> lb rb) <span class="hljs-comment">; finally, balanced case</span>
                <span class="hljs-number">-1</span> <span class="hljs-comment">; submobiles are balanced, but apply different torques in this</span>
              )
            )
          )
        )
      )
      mobile <span class="hljs-comment">; single weight is already balanced by itself</span>
    )
  )
  (<span class="hljs-name"><span class="hljs-builtin-name">></span></span> (<span class="hljs-name">weight-b</span> mobile) <span class="hljs-number">0</span>)
)
(<span class="hljs-name">balanced</span> m1)
(<span class="hljs-name">balanced</span> m2)
(<span class="hljs-name">balanced</span> m3)</code></pre>
<p>With <code>balanced</code> I was stuck, too many levels of nesting. As usual, I <a href="https://stackoverflow.com/questions/62962576/how-to-find-where-scheme-calls-integer-less">asked on StackOverflow</a>, went to sleep and in the morning found bug, then someone answered my very obvious question.</p>
<p>Part d. If we have such constructors:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-mobile</span> left right)
  (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> left right))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-branch</span> length structure)
  (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> length structure))</code></pre>
<p>We only have to change such selectors:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">right-branch</span> mobile)
  (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> mobile))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">branch-structure</span> branch)
  (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> branch))</code></pre>
<p>Layers of abstraction are useful (sometimes).</p>
<h2>Exercise 2.30</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">square-tree</span> t) 
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> 
    ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> t) nil)
    ((<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> t) (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name">square-tree</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> t)) (<span class="hljs-name">square-tree</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> t))))
    (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name">sqr</span> t))
  )
)

(<span class="hljs-name">square-tree</span>
 (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">1</span>
       (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">2</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>) <span class="hljs-number">5</span>)
       (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>)))</code></pre>
<p>Version with map:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">square-tree</span> t) 
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> t)
    (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> square-tree t)
    (<span class="hljs-name">sqr</span> t)
  )
)</code></pre>
<h2>Exercise 2.31</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">tree-map</span> f t) 
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">pair?</span></span> t)
    (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span> (t) (<span class="hljs-name">tree-map</span> f t)) t)
    (<span class="hljs-name">f</span> t)
  )
)

(<span class="hljs-name">tree-map</span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span> (x) (<span class="hljs-name"><span class="hljs-builtin-name">+</span></span> x <span class="hljs-number">1</span>))
 (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">1</span>
       (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">2</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>) <span class="hljs-number">5</span>)
       (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-number">6</span> <span class="hljs-number">7</span>)))</code></pre>
<h2>Exercise 2.32</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">subsets</span> s)
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> s)
      (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> nil)
      (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">rest</span> (<span class="hljs-name">subsets</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> s))))
        (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span>
          rest
          (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span> (ss) (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> s) ss)) rest)
        ))))</code></pre>
<p>Emtpy set has only one subset - empty. Otherwise each element in the set doubles number of elements in the set of subsets - it creates subsets that are just like subsets without that element, except that they include it.</p></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-3"><h6 class="MuiTypography-root jss6 MuiTypography-h6 MuiTypography-gutterBottom">Archives</h6><ul><li><a href="/month/2021-01/page/1">2021-01</a> <span title="posts count">(<!-- -->4<!-- -->)</span></li><li><a href="/month/2020-12/page/1">2020-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2020-09/page/1">2020-09</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-08/page/1">2020-08</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-07/page/1">2020-07</a> <span title="posts count">(<!-- -->10<!-- -->)</span></li><li><a href="/month/2020-06/page/1">2020-06</a> <span title="posts count">(<!-- -->7<!-- -->)</span></li><li><a href="/month/2018-12/page/1">2018-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li></ul><h6 class="MuiTypography-root jss6 MuiTypography-h6 MuiTypography-gutterBottom">Topics</h6><ul><li><a href="/tag/MOOC/page/1">MOOC</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/tag/SICP/page/1">SICP</a> <span title="posts count">(<!-- -->20<!-- -->)</span></li><li><a href="/tag/ideas/page/1">ideas</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/tag/notes/page/1">notes</a> <span title="posts count">(<!-- -->5<!-- -->)</span></li><li><a href="/tag/on%20writing/page/1">on writing</a> <span title="posts count">(<!-- -->3<!-- -->)</span></li></ul></div><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">© <!-- -->2021<!-- --> Bunyk Taras. Built with Material UI &amp; Next.js</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"sicp2.2.2","title":"SICP 2.2.2 Hierarchical structures","date":"2020-07-19","tags":["SICP"],"excerpt":"\u003cp\u003eAKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.\u003c/p\u003e\n\u003cp\u003eAlso here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is \"What would interpreter print\", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.\u003c/p\u003e","content":"\u003cp\u003eAKA trees. Here I learned to debug Scheme a little bit, because I wrote code that not just worked from the first try.\u003c/p\u003e\n\u003cp\u003eAlso here some trivial exercises are skipped, because one with drawing I done on paper and won't upload it here because it is useless, and another is \"What would interpreter print\", which I guessed, tested with interpreter and it was right. If you want to have solution - ask your interpreter.\u003c/p\u003e\n\u003ch2\u003eExercise 2.25\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e l))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e l (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))))))\nl\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e l))))))))))))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.27\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e x)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edeep-reverse\u003c/span\u003e l)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erev-el\u003c/span\u003e el)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e el)\n      (\u003cspan class=\"hljs-name\"\u003edeep-reverse\u003c/span\u003e el)\n      el\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e src dst)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e src)\n      dst\n      (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003erev-el\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src)) dst))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e l nil)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.28\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003efringe\u003c/span\u003e t)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e src dst)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e src) dst)\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src)) (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src)\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src) nil) dst)\n      ))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e src)\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e src) dst)\n      ))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ereverse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e t nil))\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.29\u003c/h2\u003e\n\u003cp\u003eConstructors and selectors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e left right))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e mobile))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e mobile)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e length structure)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e length structure))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e branch))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e branch)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTest data:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m1 \n  (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e \n    (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n    (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \n        (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e \n            (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n            (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n        )\n    )\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m2 \n    (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e m1)\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e m3\n    (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n    )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e mobile) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e mobile)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)))\n      (\u003cspan class=\"hljs-name\"\u003etotal-weight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)))\n    )\n    mobile \u003cspan class=\"hljs-comment\"\u003e; if not pair - it should be just weight\u003c/span\u003e\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e mobile)\n  \u003cspan class=\"hljs-comment\"\u003e; weight-b returns weight of mobile if it is balanced, otherwise - negative value\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e mobile)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e mobile)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003elb\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile))))) \u003cspan class=\"hljs-comment\"\u003e; compute left balance\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e lb \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n          \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; left submobile is not balanced, so this mobile too\u003c/span\u003e\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003erb\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile))))) \u003cspan class=\"hljs-comment\"\u003e; compute right balance\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e rb \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n              \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; right submobile is not balanced, so this mobile too\u003c/span\u003e\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e lb (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e mobile)))\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e rb (\u003cspan class=\"hljs-name\"\u003ebranch-length\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)))\n              )\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e lb rb) \u003cspan class=\"hljs-comment\"\u003e; finally, balanced case\u003c/span\u003e\n                \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e; submobiles are balanced, but apply different torques in this\u003c/span\u003e\n              )\n            )\n          )\n        )\n      )\n      mobile \u003cspan class=\"hljs-comment\"\u003e; single weight is already balanced by itself\u003c/span\u003e\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-b\u003c/span\u003e mobile) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m1)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m2)\n(\u003cspan class=\"hljs-name\"\u003ebalanced\u003c/span\u003e m3)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWith \u003ccode\u003ebalanced\u003c/code\u003e I was stuck, too many levels of nesting. As usual, I \u003ca href=\"https://stackoverflow.com/questions/62962576/how-to-find-where-scheme-calls-integer-less\"\u003easked on StackOverflow\u003c/a\u003e, went to sleep and in the morning found bug, then someone answered my very obvious question.\u003c/p\u003e\n\u003cp\u003ePart d. If we have such constructors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-mobile\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e left right))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-branch\u003c/span\u003e length structure)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e length structure))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe only have to change such selectors:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e mobile)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e mobile))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ebranch-structure\u003c/span\u003e branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e branch))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLayers of abstraction are useful (sometimes).\u003c/p\u003e\n\u003ch2\u003eExercise 2.30\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e t) nil)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e t)) (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e t))))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e t))\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e\n (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eVersion with map:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare-tree\u003c/span\u003e t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e square-tree t)\n    (\u003cspan class=\"hljs-name\"\u003esqr\u003c/span\u003e t)\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.31\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e f t) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003epair?\u003c/span\u003e\u003c/span\u003e t)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (t) (\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e f t)) t)\n    (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e t)\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003etree-map\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.32\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esubsets\u003c/span\u003e s)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e s)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e nil)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003erest\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esubsets\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e s))))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e\n          rest\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (ss) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e s) ss)) rest)\n        ))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eEmtpy set has only one subset - empty. Otherwise each element in the set doubles number of elements in the set of subsets - it creates subsets that are just like subsets without that element, except that they include it.\u003c/p\u003e"},"archives":[{"url":"/month/2021-01/page/1","id":"2021-01","count":4,"title":"2021-01"},{"url":"/month/2020-12/page/1","id":"2020-12","count":1,"title":"2020-12"},{"url":"/month/2020-09/page/1","id":"2020-09","count":2,"title":"2020-09"},{"url":"/month/2020-08/page/1","id":"2020-08","count":2,"title":"2020-08"},{"url":"/month/2020-07/page/1","id":"2020-07","count":10,"title":"2020-07"},{"url":"/month/2020-06/page/1","id":"2020-06","count":7,"title":"2020-06"},{"url":"/month/2018-12/page/1","id":"2018-12","count":1,"title":"2018-12"}],"topics":[{"url":"/tag/MOOC/page/1","id":"MOOC","title":"MOOC","count":2},{"url":"/tag/SICP/page/1","id":"SICP","title":"SICP","count":20},{"url":"/tag/ideas/page/1","id":"ideas","title":"ideas","count":1},{"url":"/tag/notes/page/1","id":"notes","title":"notes","count":5},{"url":"/tag/on writing/page/1","id":"on writing","title":"on writing","count":3}]},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.2.2"},"buildId":"lrc2VRTLiTq1Qkc5KeKdA","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>