<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>SICP 2.3.4 Huffman encoding</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/688040b3fc223486cedc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/688040b3fc223486cedc.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons-131aad2d92e69c360009.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-4f9408d32df08544de44.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" as="script"/><link rel="preload" href="/_next/static/chunks/762-bec077d9715dbffe23e5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-4d391b18df3a2ccf9664.js" as="script"/></head><body><div id="__next"><div class="MuiContainer-root MuiContainer-maxWidthMd"><div class="MuiToolbar-root MuiToolbar-regular jss1 MuiToolbar-gutters"><h1 class="MuiTypography-root jss2 MuiTypography-h5 MuiTypography-noWrap" aligh="center">Taras Bunyk</h1></div><nav class="MuiToolbar-root MuiToolbar-dense jss3 MuiToolbar-gutters"><a href="/">Home</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-5"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-9"><div class="MuiPaper-root MuiCard-root MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.3.4 Huffman encoding</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-08-02 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>Exercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.</p>
<h2>Exercise 2.67</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-leaf</span> symbol weight)
  (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-symbol">'leaf</span> symbol weight))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">leaf?</span> object)
  (<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> object) <span class="hljs-symbol">'leaf</span>))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">symbol-leaf</span> x) (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> x))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">weight-leaf</span> x) (<span class="hljs-name">caddr</span> x))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-code-tree</span> left right)
  (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> left
        right
        (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">symbols</span> left) (<span class="hljs-name">symbols</span> right))
        (<span class="hljs-name"><span class="hljs-builtin-name">+</span></span> (<span class="hljs-name">weight</span> left) (<span class="hljs-name">weight</span> right))))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">left-branch</span> tree) (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> tree))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">right-branch</span> tree) (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> tree))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">symbols</span> tree)
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name">leaf?</span> tree)
      (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> (<span class="hljs-name">symbol-leaf</span> tree))
      (<span class="hljs-name">caddr</span> tree)))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">weight</span> tree)
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name">leaf?</span> tree)
      (<span class="hljs-name">weight-leaf</span> tree)
      (<span class="hljs-name">cadddr</span> tree)))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">decode</span> bits tree)
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">decode-1</span> bits current-branch)
    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> bits)
        '()
        (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">next-branch</span>
               (<span class="hljs-name">choose-branch</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> bits) current-branch)))
          (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name">leaf?</span> next-branch)
              (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name">symbol-leaf</span> next-branch)
                    (<span class="hljs-name">decode-1</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> bits) tree))
              (<span class="hljs-name">decode-1</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> bits) next-branch)))))
  (<span class="hljs-name">decode-1</span> bits tree))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">choose-branch</span> bit branch)
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> bit <span class="hljs-number">0</span>) (<span class="hljs-name">left-branch</span> branch))
        ((<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> bit <span class="hljs-number">1</span>) (<span class="hljs-name">right-branch</span> branch))
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"bad bit -- CHOOSE-BRANCH"</span> bit))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">adjoin-set</span> x set)
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> set) (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> x))
        ((<span class="hljs-name"><span class="hljs-builtin-name">&#x3C;</span></span> (<span class="hljs-name">weight</span> x) (<span class="hljs-name">weight</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> set))) (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> x set))
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> set)
                    (<span class="hljs-name">adjoin-set</span> x (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> set))))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> sample-tree
  (<span class="hljs-name">make-code-tree</span> (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'A</span> <span class="hljs-number">4</span>)
                  (<span class="hljs-name">make-code-tree</span>
                   (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'B</span> <span class="hljs-number">2</span>)
                   (<span class="hljs-name">make-code-tree</span> (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'D</span> <span class="hljs-number">1</span>)
                                   (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'C</span> <span class="hljs-number">1</span>)))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> sample-message '(<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>))

(<span class="hljs-name">decode</span> sample-message sample-tree)
<span class="hljs-comment">;Value 14: (a d a b b c a)</span></code></pre>
<h2>Exercise 2.68</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">encode</span> message tree)
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> message)
      '()
      (<span class="hljs-name"><span class="hljs-builtin-name">append</span></span> (<span class="hljs-name">encode-symbol</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> message) tree)
              (<span class="hljs-name">encode</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> message) tree))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">encode-symbol</span> sym tree)
    (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> 
        ((<span class="hljs-name">leaf?</span> tree) '())
        ((<span class="hljs-name">element-of-set?</span> sym (<span class="hljs-name">symbols</span> (<span class="hljs-name">left-branch</span> tree)))
         (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> <span class="hljs-number">0</span> (<span class="hljs-name">encode-symbol</span> sym (<span class="hljs-name">left-branch</span> tree))))
        ((<span class="hljs-name">element-of-set?</span> sym (<span class="hljs-name">symbols</span> (<span class="hljs-name">right-branch</span> tree)))
         (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> <span class="hljs-number">1</span> (<span class="hljs-name">encode-symbol</span> sym (<span class="hljs-name">right-branch</span> tree))))
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"encode-symbol fails for symbol"</span> sym <span class="hljs-string">" with tree "</span> tree))
    )
)

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">element-of-set?</span> x set)
    (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span>
        ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> set) <span class="hljs-literal">#f</span>)
        ((<span class="hljs-name"><span class="hljs-builtin-name">equal?</span></span> x (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> set)) <span class="hljs-literal">#t</span>)
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name">element-of-set?</span> x (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> set)))
    )
)


(<span class="hljs-name">encode</span> '(a d a b b c a) sample-tree)</code></pre>
<h2>Exercise 2.69</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-leaf-set</span> pairs)
  (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> pairs)
      '()
      (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">pair</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> pairs)))
        (<span class="hljs-name">adjoin-set</span> (<span class="hljs-name">make-leaf</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> pair)    <span class="hljs-comment">; symbol</span>
                               (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> pair))  <span class="hljs-comment">; frequency</span>
                    (<span class="hljs-name">make-leaf-set</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> pairs))))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">adjoin-set</span> x set)
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> set) (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> x))
        ((<span class="hljs-name"><span class="hljs-builtin-name">&#x3C;</span></span> (<span class="hljs-name">weight</span> x) (<span class="hljs-name">weight</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> set))) (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> x set))
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> set)
                    (<span class="hljs-name">adjoin-set</span> x (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> set))))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">generate-huffman-tree</span> pairs)
  (<span class="hljs-name">successive-merge</span> (<span class="hljs-name">make-leaf-set</span> pairs)))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">successive-merge</span> forest)
    (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> forest)) <span class="hljs-comment">; single element</span>
        (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> forest) <span class="hljs-comment">; means we merged all trees and could return the only element</span>
        (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ( <span class="hljs-comment">; othwerise let's take two smallest</span>
            (<span class="hljs-name">smallest1</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> forest))
            (<span class="hljs-name">smallest2</span> (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> forest))
            (<span class="hljs-name">tail</span> (<span class="hljs-name">cddr</span> forest))
        )
            (<span class="hljs-name">successive-merge</span> (<span class="hljs-name">adjoin-set</span>
                (<span class="hljs-name">make-code-tree</span> smallest1 smallest2) <span class="hljs-comment">; merge them</span>
                tail <span class="hljs-comment">; and add to the remaining set of trees</span>
            ))
        )
    )
)

(<span class="hljs-name">generate-huffman-tree</span> '((a <span class="hljs-number">1</span>) (b <span class="hljs-number">1</span>) (c <span class="hljs-number">5</span>)))</code></pre>
<h2>Exercise 2.70</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> rock-code (<span class="hljs-name">generate-huffman-tree</span> '(
    (A 	    <span class="hljs-number">2</span>)
    (BOOM 	<span class="hljs-number">1</span>)
    (GET 	<span class="hljs-number">2</span>)
    (JOB 	<span class="hljs-number">2</span>)
    (NA 	<span class="hljs-number">16</span>)
    (SHA 	<span class="hljs-number">4</span>)
    (YIP 	<span class="hljs-number">9</span>)
    (WAH 	<span class="hljs-number">1</span>) 
)))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> rock-song '(Get a job

Sha na na na na na na na na

Get a job

Sha na na na na na na na na

Wah yip yip yip yip yip yip yip yip yip

Sha boom
))</code></pre>
<p>How many bits are required for encoding?</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">length</span></span> (<span class="hljs-name">encode</span> rock-song rock-code))
<span class="hljs-comment">;Value: 84</span></code></pre>
<p>What is the smallest number of bits that would be needed to encode this song if we used a fixed-length code for the eight-symbol alphabet?</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> <span class="hljs-number">3</span> (<span class="hljs-name"><span class="hljs-builtin-name">length</span></span> rock-song))
<span class="hljs-comment">;Value: 108</span></code></pre>
<h2>Exercise 2.71</h2>
<p>Most frequent symbol is encoded in one bit, least frequent - in n bits.</p>
<h2>Exercise 2.72</h2>
<p>If search in set is linear, then for the most frequent symbol endoing is done in O(n), for the least frequent - in O(n2). If search is done in log(n) - then encoding could be done from log(n) to n*log(n)</p></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-3"><h6 class="MuiTypography-root jss5 MuiTypography-h6 MuiTypography-gutterBottom">Archives</h6><ul><li><a href="/month/2018-12/page/1">2018-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2020-06/page/1">2020-06</a> <span title="posts count">(<!-- -->7<!-- -->)</span></li><li><a href="/month/2020-07/page/1">2020-07</a> <span title="posts count">(<!-- -->10<!-- -->)</span></li><li><a href="/month/2020-08/page/1">2020-08</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-09/page/1">2020-09</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-12/page/1">2020-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2021-01/page/1">2021-01</a> <span title="posts count">(<!-- -->4<!-- -->)</span></li></ul><h6 class="MuiTypography-root jss5 MuiTypography-h6 MuiTypography-gutterBottom">Topics</h6><ul><li><a href="/tag/MOOC/page/1">MOOC</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/tag/SICP/page/1">SICP</a> <span title="posts count">(<!-- -->20<!-- -->)</span></li><li><a href="/tag/ideas/page/1">ideas</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/tag/notes/page/1">notes</a> <span title="posts count">(<!-- -->5<!-- -->)</span></li><li><a href="/tag/on%20writing/page/1">on writing</a> <span title="posts count">(<!-- -->3<!-- -->)</span></li></ul></div><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">© <!-- -->2021<!-- --> Bunyk Taras. Built with Material UI &amp; Next.js</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"sicp2.3.4","title":"SICP 2.3.4 Huffman encoding","date":"2020-08-02","tags":["SICP"],"excerpt":"\u003cp\u003eExercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.\u003c/p\u003e","content":"\u003cp\u003eExercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.\u003c/p\u003e\n\u003ch2\u003eExercise 2.67\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e symbol weight)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e symbol weight))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e object)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e object) \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e x))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e x))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e left\n        right\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e right))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e right))))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e tree))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e tree))\n      (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e tree)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003ecadddr\u003c/span\u003e tree)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e bits tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits current-branch)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e bits)\n        '()\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003enext-branch\u003c/span\u003e\n               (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e bits) current-branch)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e next-branch)\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e next-branch)\n                    (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) tree))\n              (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) next-branch)))))\n  (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e bit branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e branch))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e branch))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"bad bit -- CHOOSE-BRANCH\"\u003c/span\u003e bit))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-tree\n  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'A\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n                  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e\n                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'B\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n                   (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'D\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n                                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'C\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-message '(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e sample-message sample-tree)\n\u003cspan class=\"hljs-comment\"\u003e;Value 14: (a d a b b c a)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.68\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e message tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e message)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e message) tree)\n              (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e message) tree))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym tree)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e \n        ((\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree) '())\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree))))\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree))))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"encode-symbol fails for symbol\"\u003c/span\u003e sym \u003cspan class=\"hljs-string\"\u003e\" with tree \"\u003c/span\u003e tree))\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eequal?\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set)))\n    )\n)\n\n\n(\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e '(a d a b b c a) sample-tree)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.69\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e pairs)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003epair\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pairs)))\n        (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair)    \u003cspan class=\"hljs-comment\"\u003e; symbol\u003c/span\u003e\n                               (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))  \u003cspan class=\"hljs-comment\"\u003e; frequency\u003c/span\u003e\n                    (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e pairs))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e forest)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e forest)) \u003cspan class=\"hljs-comment\"\u003e; single element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest) \u003cspan class=\"hljs-comment\"\u003e; means we merged all trees and could return the only element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ( \u003cspan class=\"hljs-comment\"\u003e; othwerise let's take two smallest\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003esmallest1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003esmallest2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003etail\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e forest))\n        )\n            (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e smallest1 smallest2) \u003cspan class=\"hljs-comment\"\u003e; merge them\u003c/span\u003e\n                tail \u003cspan class=\"hljs-comment\"\u003e; and add to the remaining set of trees\u003c/span\u003e\n            ))\n        )\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '((a \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (b \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (c \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.70\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-code (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '(\n    (A \t    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (BOOM \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    (GET \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (JOB \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (NA \t\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e)\n    (SHA \t\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    (YIP \t\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e)\n    (WAH \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \n)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-song '(Get a job\n\nSha na na na na na na na na\n\nGet a job\n\nSha na na na na na na na na\n\nWah yip yip yip yip yip yip yip yip yip\n\nSha boom\n))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHow many bits are required for encoding?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e rock-song rock-code))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 84\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhat is the smallest number of bits that would be needed to encode this song if we used a fixed-length code for the eight-symbol alphabet?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elength\u003c/span\u003e\u003c/span\u003e rock-song))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 108\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.71\u003c/h2\u003e\n\u003cp\u003eMost frequent symbol is encoded in one bit, least frequent - in n bits.\u003c/p\u003e\n\u003ch2\u003eExercise 2.72\u003c/h2\u003e\n\u003cp\u003eIf search in set is linear, then for the most frequent symbol endoing is done in O(n), for the least frequent - in O(n2). If search is done in log(n) - then encoding could be done from log(n) to n*log(n)\u003c/p\u003e"},"archives":[{"url":"/month/2018-12/page/1","id":"2018-12","count":1,"title":"2018-12"},{"url":"/month/2020-06/page/1","id":"2020-06","count":7,"title":"2020-06"},{"url":"/month/2020-07/page/1","id":"2020-07","count":10,"title":"2020-07"},{"url":"/month/2020-08/page/1","id":"2020-08","count":2,"title":"2020-08"},{"url":"/month/2020-09/page/1","id":"2020-09","count":2,"title":"2020-09"},{"url":"/month/2020-12/page/1","id":"2020-12","count":1,"title":"2020-12"},{"url":"/month/2021-01/page/1","id":"2021-01","count":4,"title":"2021-01"}],"topics":[{"url":"/tag/MOOC/page/1","id":"MOOC","title":"MOOC","count":2},{"url":"/tag/SICP/page/1","id":"SICP","title":"SICP","count":20},{"url":"/tag/ideas/page/1","id":"ideas","title":"ideas","count":1},{"url":"/tag/notes/page/1","id":"notes","title":"notes","count":5},{"url":"/tag/on writing/page/1","id":"on writing","title":"on writing","count":3}]},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.3.4"},"buildId":"Zn0comZmfh30_fMqSLkCB","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" async=""></script><script src="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" async=""></script><script src="/_next/static/chunks/commons-131aad2d92e69c360009.js" async=""></script><script src="/_next/static/chunks/main-4f9408d32df08544de44.js" async=""></script><script src="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" async=""></script><script src="/_next/static/chunks/762-bec077d9715dbffe23e5.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4d391b18df3a2ccf9664.js" async=""></script><script src="/_next/static/Zn0comZmfh30_fMqSLkCB/_buildManifest.js" async=""></script><script src="/_next/static/Zn0comZmfh30_fMqSLkCB/_ssgManifest.js" async=""></script></body></html>