<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>SICP 2.3.4 Huffman encoding</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/b53cc6ef9e9e352d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b53cc6ef9e9e352d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-959cc2ac3c742fb4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ec0fdebf93e8fc69.js" defer=""></script><script src="/_next/static/chunks/996-372da0b0d3708a80.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-959ba1136e063a38.js" defer=""></script><script src="/_next/static/E7MzhBhs3qKTz3zU5oPB4/_buildManifest.js" defer=""></script><script src="/_next/static/E7MzhBhs3qKTz3zU5oPB4/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><h1 id="top">Taras Bunyk</h1><nav><a href="/">Home</a><a href="http://bunyk.github.io/mandala/">Snowflake drawing</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><article><h1>SICP 2.3.4 Huffman encoding</h1><div><em>Published: 2020-08-02T16:20:22.000Z</em></div><div><p>Exercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.</p>
<h2 id="exercise-267">Exercise 2.67</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-leaf</span> symbol weight)
  (<span class="hljs-name"><span class="hljs-built_in">list</span></span> <span class="hljs-symbol">'leaf</span> symbol weight))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">leaf?</span> object)
  (<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> object) <span class="hljs-symbol">'leaf</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">symbol-leaf</span> x) (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> x))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">weight-leaf</span> x) (<span class="hljs-name">caddr</span> x))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-code-tree</span> left right)
  (<span class="hljs-name"><span class="hljs-built_in">list</span></span> left
        right
        (<span class="hljs-name"><span class="hljs-built_in">append</span></span> (<span class="hljs-name">symbols</span> left) (<span class="hljs-name">symbols</span> right))
        (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">weight</span> left) (<span class="hljs-name">weight</span> right))))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">left-branch</span> tree) (<span class="hljs-name"><span class="hljs-built_in">car</span></span> tree))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">right-branch</span> tree) (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> tree))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">symbols</span> tree)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name">leaf?</span> tree)
      (<span class="hljs-name"><span class="hljs-built_in">list</span></span> (<span class="hljs-name">symbol-leaf</span> tree))
      (<span class="hljs-name">caddr</span> tree)))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">weight</span> tree)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name">leaf?</span> tree)
      (<span class="hljs-name">weight-leaf</span> tree)
      (<span class="hljs-name">cadddr</span> tree)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">decode</span> bits tree)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">decode-1</span> bits current-branch)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> bits)
        '()
        (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">next-branch</span>
               (<span class="hljs-name">choose-branch</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> bits) current-branch)))
          (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name">leaf?</span> next-branch)
              (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name">symbol-leaf</span> next-branch)
                    (<span class="hljs-name">decode-1</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> bits) tree))
              (<span class="hljs-name">decode-1</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> bits) next-branch)))))
  (<span class="hljs-name">decode-1</span> bits tree))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">choose-branch</span> bit branch)
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span> ((<span class="hljs-name"><span class="hljs-built_in">=</span></span> bit <span class="hljs-number">0</span>) (<span class="hljs-name">left-branch</span> branch))
        ((<span class="hljs-name"><span class="hljs-built_in">=</span></span> bit <span class="hljs-number">1</span>) (<span class="hljs-name">right-branch</span> branch))
        (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"bad bit -- CHOOSE-BRANCH"</span> bit))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">adjoin-set</span> x set)
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span> ((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> set) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> x))
        ((<span class="hljs-name"><span class="hljs-built_in">&#x3C;</span></span> (<span class="hljs-name">weight</span> x) (<span class="hljs-name">weight</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> set))) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> x set))
        (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> set)
                    (<span class="hljs-name">adjoin-set</span> x (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> set))))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> sample-tree
  (<span class="hljs-name">make-code-tree</span> (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'A</span> <span class="hljs-number">4</span>)
                  (<span class="hljs-name">make-code-tree</span>
                   (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'B</span> <span class="hljs-number">2</span>)
                   (<span class="hljs-name">make-code-tree</span> (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'D</span> <span class="hljs-number">1</span>)
                                   (<span class="hljs-name">make-leaf</span> <span class="hljs-symbol">'C</span> <span class="hljs-number">1</span>)))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> sample-message '(<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>))

(<span class="hljs-name">decode</span> sample-message sample-tree)
<span class="hljs-comment">;Value 14: (a d a b b c a)</span></code></pre>
<h2 id="exercise-268">Exercise 2.68</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">encode</span> message tree)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> message)
      '()
      (<span class="hljs-name"><span class="hljs-built_in">append</span></span> (<span class="hljs-name">encode-symbol</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> message) tree)
              (<span class="hljs-name">encode</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> message) tree))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">encode-symbol</span> sym tree)
    (<span class="hljs-name"><span class="hljs-built_in">cond</span></span> 
        ((<span class="hljs-name">leaf?</span> tree) '())
        ((<span class="hljs-name">element-of-set?</span> sym (<span class="hljs-name">symbols</span> (<span class="hljs-name">left-branch</span> tree)))
         (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">0</span> (<span class="hljs-name">encode-symbol</span> sym (<span class="hljs-name">left-branch</span> tree))))
        ((<span class="hljs-name">element-of-set?</span> sym (<span class="hljs-name">symbols</span> (<span class="hljs-name">right-branch</span> tree)))
         (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">1</span> (<span class="hljs-name">encode-symbol</span> sym (<span class="hljs-name">right-branch</span> tree))))
        (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"encode-symbol fails for symbol"</span> sym <span class="hljs-string">" with tree "</span> tree))
    )
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">element-of-set?</span> x set)
    (<span class="hljs-name"><span class="hljs-built_in">cond</span></span>
        ((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> set) <span class="hljs-literal">#f</span>)
        ((<span class="hljs-name"><span class="hljs-built_in">equal?</span></span> x (<span class="hljs-name"><span class="hljs-built_in">car</span></span> set)) <span class="hljs-literal">#t</span>)
        (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">element-of-set?</span> x (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> set)))
    )
)


(<span class="hljs-name">encode</span> '(a d a b b c a) sample-tree)</code></pre>
<h2 id="exercise-269">Exercise 2.69</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-leaf-set</span> pairs)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> pairs)
      '()
      (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">pair</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> pairs)))
        (<span class="hljs-name">adjoin-set</span> (<span class="hljs-name">make-leaf</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> pair)    <span class="hljs-comment">; symbol</span>
                               (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> pair))  <span class="hljs-comment">; frequency</span>
                    (<span class="hljs-name">make-leaf-set</span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> pairs))))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">adjoin-set</span> x set)
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span> ((<span class="hljs-name"><span class="hljs-built_in">null?</span></span> set) (<span class="hljs-name"><span class="hljs-built_in">list</span></span> x))
        ((<span class="hljs-name"><span class="hljs-built_in">&#x3C;</span></span> (<span class="hljs-name">weight</span> x) (<span class="hljs-name">weight</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> set))) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> x set))
        (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> set)
                    (<span class="hljs-name">adjoin-set</span> x (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> set))))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">generate-huffman-tree</span> pairs)
  (<span class="hljs-name">successive-merge</span> (<span class="hljs-name">make-leaf-set</span> pairs)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">successive-merge</span> forest)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">null?</span></span> (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> forest)) <span class="hljs-comment">; single element</span>
        (<span class="hljs-name"><span class="hljs-built_in">car</span></span> forest) <span class="hljs-comment">; means we merged all trees and could return the only element</span>
        (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ( <span class="hljs-comment">; othwerise let's take two smallest</span>
            (<span class="hljs-name">smallest1</span> (<span class="hljs-name"><span class="hljs-built_in">car</span></span> forest))
            (<span class="hljs-name">smallest2</span> (<span class="hljs-name"><span class="hljs-built_in">cadr</span></span> forest))
            (<span class="hljs-name">tail</span> (<span class="hljs-name">cddr</span> forest))
        )
            (<span class="hljs-name">successive-merge</span> (<span class="hljs-name">adjoin-set</span>
                (<span class="hljs-name">make-code-tree</span> smallest1 smallest2) <span class="hljs-comment">; merge them</span>
                tail <span class="hljs-comment">; and add to the remaining set of trees</span>
            ))
        )
    )
)

(<span class="hljs-name">generate-huffman-tree</span> '((a <span class="hljs-number">1</span>) (b <span class="hljs-number">1</span>) (c <span class="hljs-number">5</span>)))</code></pre>
<h2 id="exercise-270">Exercise 2.70</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> rock-code (<span class="hljs-name">generate-huffman-tree</span> '(
    (A 	    <span class="hljs-number">2</span>)
    (BOOM 	<span class="hljs-number">1</span>)
    (GET 	<span class="hljs-number">2</span>)
    (JOB 	<span class="hljs-number">2</span>)
    (NA 	<span class="hljs-number">16</span>)
    (SHA 	<span class="hljs-number">4</span>)
    (YIP 	<span class="hljs-number">9</span>)
    (WAH 	<span class="hljs-number">1</span>) 
)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> rock-song '(Get a job

Sha na na na na na na na na

Get a job

Sha na na na na na na na na

Wah yip yip yip yip yip yip yip yip yip

Sha boom
))</code></pre>
<p>How many bits are required for encoding?</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">length</span></span> (<span class="hljs-name">encode</span> rock-song rock-code))
<span class="hljs-comment">;Value: 84</span></code></pre>
<p>What is the smallest number of bits that would be needed to encode this song if we used a fixed-length code for the eight-symbol alphabet?</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">*</span></span> <span class="hljs-number">3</span> (<span class="hljs-name"><span class="hljs-built_in">length</span></span> rock-song))
<span class="hljs-comment">;Value: 108</span></code></pre>
<h2 id="exercise-271">Exercise 2.71</h2>
<p>Most frequent symbol is encoded in one bit, least frequent - in n bits.</p>
<h2 id="exercise-272">Exercise 2.72</h2>
<p>If search in set is linear, then for the most frequent symbol endoing is done in O(n), for the least frequent - in O(n2). If search is done in log(n) - then encoding could be done from log(n) to n*log(n)</p></div></article><div><div id="disqus_thread"></div></div><nav><a href="/">Home</a><a href="#top">Back to top</a></nav><footer>© <!-- -->2022<!-- --> Bunyk Taras. Built with Next.js</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"sicp2.3.4","title":"SICP 2.3.4 Huffman encoding","date":"2020-08-02T16:20:22.000Z","tags":["SICP"],"updated_at":"2021-04-20T00:38:16+02:00","content":"\u003cp\u003eExercises to use sets and trees in practice. This topic reminds me of project in Scala course by Martin Odersky.\u003c/p\u003e\n\u003ch2 id=\"exercise-267\"\u003eExercise 2.67\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e symbol weight)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e symbol weight))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e object)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e object) \u003cspan class=\"hljs-symbol\"\u003e'leaf\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e x))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e x))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e left right)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e left\n        right\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e right))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e left) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e right))))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e tree))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e tree))\n      (\u003cspan class=\"hljs-name\"\u003ecaddr\u003c/span\u003e tree)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003eweight-leaf\u003c/span\u003e tree)\n      (\u003cspan class=\"hljs-name\"\u003ecadddr\u003c/span\u003e tree)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e bits tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits current-branch)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e bits)\n        '()\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003enext-branch\u003c/span\u003e\n               (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e bits) current-branch)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e next-branch)\n              (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esymbol-leaf\u003c/span\u003e next-branch)\n                    (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) tree))\n              (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e bits) next-branch)))))\n  (\u003cspan class=\"hljs-name\"\u003edecode-1\u003c/span\u003e bits tree))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003echoose-branch\u003c/span\u003e bit branch)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e branch))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e bit \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e branch))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"bad bit -- CHOOSE-BRANCH\"\u003c/span\u003e bit))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-tree\n  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'A\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n                  (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e\n                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'B\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n                   (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'D\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n                                   (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'C\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e sample-message '(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003edecode\u003c/span\u003e sample-message sample-tree)\n\u003cspan class=\"hljs-comment\"\u003e;Value 14: (a d a b b c a)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-268\"\u003eExercise 2.68\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e message tree)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e message)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eappend\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e message) tree)\n              (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e message) tree))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym tree)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e \n        ((\u003cspan class=\"hljs-name\"\u003eleaf?\u003c/span\u003e tree) '())\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eleft-branch\u003c/span\u003e tree))))\n        ((\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003esymbols\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree)))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode-symbol\u003c/span\u003e sym (\u003cspan class=\"hljs-name\"\u003eright-branch\u003c/span\u003e tree))))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"encode-symbol fails for symbol\"\u003c/span\u003e sym \u003cspan class=\"hljs-string\"\u003e\" with tree \"\u003c/span\u003e tree))\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x set)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eequal?\u003c/span\u003e\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)) \u003cspan class=\"hljs-literal\"\u003e#t\u003c/span\u003e)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eelement-of-set?\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set)))\n    )\n)\n\n\n(\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e '(a d a b b c a) sample-tree)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-269\"\u003eExercise 2.69\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e pairs)\n      '()\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003epair\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e pairs)))\n        (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e pair)    \u003cspan class=\"hljs-comment\"\u003e; symbol\u003c/span\u003e\n                               (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e pair))  \u003cspan class=\"hljs-comment\"\u003e; frequency\u003c/span\u003e\n                    (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e pairs))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x set)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e set) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e x))\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u0026#x3C;\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eweight\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e set))) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e x set))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e set)\n                    (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e x (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e set))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e pairs)\n  (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-leaf-set\u003c/span\u003e pairs)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e forest)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e forest)) \u003cspan class=\"hljs-comment\"\u003e; single element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest) \u003cspan class=\"hljs-comment\"\u003e; means we merged all trees and could return the only element\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ( \u003cspan class=\"hljs-comment\"\u003e; othwerise let's take two smallest\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003esmallest1\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003esmallest2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecadr\u003c/span\u003e\u003c/span\u003e forest))\n            (\u003cspan class=\"hljs-name\"\u003etail\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e forest))\n        )\n            (\u003cspan class=\"hljs-name\"\u003esuccessive-merge\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadjoin-set\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003emake-code-tree\u003c/span\u003e smallest1 smallest2) \u003cspan class=\"hljs-comment\"\u003e; merge them\u003c/span\u003e\n                tail \u003cspan class=\"hljs-comment\"\u003e; and add to the remaining set of trees\u003c/span\u003e\n            ))\n        )\n    )\n)\n\n(\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '((a \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (b \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) (c \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-270\"\u003eExercise 2.70\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-code (\u003cspan class=\"hljs-name\"\u003egenerate-huffman-tree\u003c/span\u003e '(\n    (A \t    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (BOOM \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n    (GET \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (JOB \t\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n    (NA \t\u003cspan class=\"hljs-number\"\u003e16\u003c/span\u003e)\n    (SHA \t\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)\n    (YIP \t\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003e)\n    (WAH \t\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \n)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e rock-song '(Get a job\n\nSha na na na na na na na na\n\nGet a job\n\nSha na na na na na na na na\n\nWah yip yip yip yip yip yip yip yip yip\n\nSha boom\n))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHow many bits are required for encoding?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elength\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eencode\u003c/span\u003e rock-song rock-code))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 84\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhat is the smallest number of bits that would be needed to encode this song if we used a fixed-length code for the eight-symbol alphabet?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elength\u003c/span\u003e\u003c/span\u003e rock-song))\n\u003cspan class=\"hljs-comment\"\u003e;Value: 108\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-271\"\u003eExercise 2.71\u003c/h2\u003e\n\u003cp\u003eMost frequent symbol is encoded in one bit, least frequent - in n bits.\u003c/p\u003e\n\u003ch2 id=\"exercise-272\"\u003eExercise 2.72\u003c/h2\u003e\n\u003cp\u003eIf search in set is linear, then for the most frequent symbol endoing is done in O(n), for the least frequent - in O(n2). If search is done in log(n) - then encoding could be done from log(n) to n*log(n)\u003c/p\u003e"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.3.4"},"buildId":"E7MzhBhs3qKTz3zU5oPB4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>