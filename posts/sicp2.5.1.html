<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>SICP 2.5.1 Generic arithmetic operations</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/b53cc6ef9e9e352d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b53cc6ef9e9e352d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-959cc2ac3c742fb4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ec0fdebf93e8fc69.js" defer=""></script><script src="/_next/static/chunks/996-372da0b0d3708a80.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-959ba1136e063a38.js" defer=""></script><script src="/_next/static/eCLc5qo0ajB_-kSJKK-oM/_buildManifest.js" defer=""></script><script src="/_next/static/eCLc5qo0ajB_-kSJKK-oM/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><h1 id="top">Taras Bunyk</h1><nav><a href="/">Home</a><a href="http://bunyk.github.io/mandala/">Snowflake drawing</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><article><h1>SICP 2.5.1 Generic arithmetic operations</h1><div><em>Published: 2020-09-02T17:27:13.000Z</em></div><div><p>In <a href="/posts/sicp2.4">previous post</a> I have used wrong StackOverflow answer. :) Or, to be more precise, right answer for that section, but useless here, as we want to store in table functions for multiple arguments.</p>
<p><a href="https://stackoverflow.com/a/19114031/816449">Correct answer</a> that supports lists looks like this:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> *op-table* (<span class="hljs-name">make-hash-table</span>))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">put</span> op type proc)
  (<span class="hljs-name">hash-table/put!</span> *op-table* (<span class="hljs-name"><span class="hljs-built_in">list</span></span> op type) proc))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">get</span> op type)
  (<span class="hljs-name">hash-table/get</span> *op-table* (<span class="hljs-name"><span class="hljs-built_in">list</span></span> op type) <span class="hljs-literal">#f</span>))</code></pre>
<p>Also I needed to copypaste a lot of code to be able to start working on <a href="#exercise-277">first exercise</a>:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">attach-tag</span> type-tag contents)
  (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> type-tag contents))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">type-tag</span> datum)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> datum)
      (<span class="hljs-name"><span class="hljs-built_in">car</span></span> datum)
      (<span class="hljs-name">error</span> <span class="hljs-string">"Bad tagged datum -- TYPE-TAG"</span> datum)))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">contents</span> datum)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> datum)
      (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> datum)
      (<span class="hljs-name">error</span> <span class="hljs-string">"Bad tagged datum -- CONTENTS"</span> datum)))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">apply-generic</span> op . args)
  (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">type-tags</span> (<span class="hljs-name"><span class="hljs-built_in">map</span></span> type-tag args)))
    (<span class="hljs-name"><span class="hljs-built_in">let</span></span> ((<span class="hljs-name">proc</span> (<span class="hljs-name">get</span> op type-tags)))
      (<span class="hljs-name"><span class="hljs-built_in">if</span></span> proc
          (<span class="hljs-name"><span class="hljs-built_in">apply</span></span> proc (<span class="hljs-name"><span class="hljs-built_in">map</span></span> contents args))
          (<span class="hljs-name">error</span>
            <span class="hljs-string">"No method for these types -- APPLY-GENERIC"</span>
            (<span class="hljs-name"><span class="hljs-built_in">list</span></span> op type-tags))))))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'real-part</span> z))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'imag-part</span> z))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'magnitude</span> z))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'angle</span> z))



(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">install-rectangular-package</span>)
  <span class="hljs-comment">;; internal procedures</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">car</span></span> z))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> z))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-real-imag</span> x y) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> x y))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z)
    (<span class="hljs-name"><span class="hljs-built_in">sqrt</span></span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">square</span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z))
             (<span class="hljs-name">square</span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z)))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z)
    (<span class="hljs-name"><span class="hljs-built_in">atan</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z)))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-mag-ang</span> r a) 
    (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name"><span class="hljs-built_in">*</span></span> r (<span class="hljs-name"><span class="hljs-built_in">cos</span></span> a)) (<span class="hljs-name"><span class="hljs-built_in">*</span></span> r (<span class="hljs-name"><span class="hljs-built_in">sin</span></span> a))))
  <span class="hljs-comment">;; interface to the rest of the system</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">tag</span> x) (<span class="hljs-name">attach-tag</span> <span class="hljs-symbol">'rectangular</span> x))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'real-part</span> '(rectangular) real-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'imag-part</span> '(rectangular) imag-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'magnitude</span> '(rectangular) magnitude)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'angle</span> '(rectangular) angle)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-real-imag</span> <span class="hljs-symbol">'rectangular</span> 
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-real-imag</span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-mag-ang</span> <span class="hljs-symbol">'rectangular</span> 
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (r a) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-mag-ang</span> r a))))
  <span class="hljs-symbol">'done</span>)
(<span class="hljs-name">install-rectangular-package</span>)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">install-polar-package</span>)
  <span class="hljs-comment">;; internal procedures</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">car</span></span> z))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> z))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-mag-ang</span> r a) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> r a))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z)
    (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">cos</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z)
    (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z) (<span class="hljs-name"><span class="hljs-built_in">sin</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-real-imag</span> x y) 
    (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> (<span class="hljs-name"><span class="hljs-built_in">sqrt</span></span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">square</span> x) (<span class="hljs-name">square</span> y)))
          (<span class="hljs-name"><span class="hljs-built_in">atan</span></span> y x)))
  <span class="hljs-comment">;; interface to the rest of the system</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">tag</span> x) (<span class="hljs-name">attach-tag</span> <span class="hljs-symbol">'polar</span> x))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'real-part</span> '(polar) real-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'imag-part</span> '(polar) imag-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'magnitude</span> '(polar) magnitude)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'angle</span> '(polar) angle)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-real-imag</span> <span class="hljs-symbol">'polar</span>
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-real-imag</span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-mag-ang</span> <span class="hljs-symbol">'polar</span> 
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (r a) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-mag-ang</span> r a))))
  <span class="hljs-symbol">'done</span>)
(<span class="hljs-name">install-rectangular-package</span>)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">install-complex-package</span>)
  <span class="hljs-comment">;; imported procedures from rectangular and polar packages</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-real-imag</span> x y)
    ((<span class="hljs-name">get</span> <span class="hljs-symbol">'make-from-real-imag</span> <span class="hljs-symbol">'rectangular</span>) x y))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">make-from-mag-ang</span> r a)
    ((<span class="hljs-name">get</span> <span class="hljs-symbol">'make-from-mag-ang</span> <span class="hljs-symbol">'polar</span>) r a))
  <span class="hljs-comment">;; internal procedures</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">add-complex</span> z1 z2)
    (<span class="hljs-name">make-from-real-imag</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z2))
                         (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z2))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sub-complex</span> z1 z2)
    (<span class="hljs-name">make-from-real-imag</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> z2))
                         (<span class="hljs-name"><span class="hljs-built_in">-</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> z2))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">mul-complex</span> z1 z2)
    (<span class="hljs-name">make-from-mag-ang</span> (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z2))
                       (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z2))))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">div-complex</span> z1 z2)
    (<span class="hljs-name">make-from-mag-ang</span> (<span class="hljs-name"><span class="hljs-built_in">/</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z2))
                       (<span class="hljs-name"><span class="hljs-built_in">-</span></span> (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z1) (<span class="hljs-name"><span class="hljs-built_in">angle</span></span> z2))))
  <span class="hljs-comment">;; interface to rest of the system</span>
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">tag</span> z) (<span class="hljs-name">attach-tag</span> <span class="hljs-symbol">'complex</span> z))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'add</span> '(complex complex)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (z1 z2) (<span class="hljs-name">tag</span> (<span class="hljs-name">add-complex</span> z1 z2))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'sub</span> '(complex complex)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (z1 z2) (<span class="hljs-name">tag</span> (<span class="hljs-name">sub-complex</span> z1 z2))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'mul</span> '(complex complex)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (z1 z2) (<span class="hljs-name">tag</span> (<span class="hljs-name">mul-complex</span> z1 z2))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'div</span> '(complex complex)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (z1 z2) (<span class="hljs-name">tag</span> (<span class="hljs-name">div-complex</span> z1 z2))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-real-imag</span> <span class="hljs-symbol">'complex</span>
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-real-imag</span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make-from-mag-ang</span> <span class="hljs-symbol">'complex</span>
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (r a) (<span class="hljs-name">tag</span> (<span class="hljs-name">make-from-mag-ang</span> r a))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'real-part</span> '(complex) real-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'imag-part</span> '(complex) imag-part)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'magnitude</span> '(complex) magnitude)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'angle</span> '(complex) angle)
  <span class="hljs-symbol">'done</span>)
(<span class="hljs-name">install-complex-package</span>)</code></pre>
<h2 id="exercise-277">Exercise 2.77</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> z (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'complex</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'rectangular</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))))

(<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> z)</code></pre>
<p>It calls <code>apply-generic</code> to do operation <code>'magnitude</code> with z</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'magnitude</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'complex</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'rectangular</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))))</code></pre>
<p><code>apply-generic</code> looks for operation <code>'magnitude</code> for <code>'complex</code> numbers, and applies it to value inside</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">apply</span></span> (<span class="hljs-name">get</span> <span class="hljs-symbol">'magnitude</span> <span class="hljs-symbol">'complex</span>) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'rectangular</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>)))</code></pre>
<p>That operation, thanks to Alyssa P. Hacker, is just application of same <code>magnitude</code> function, but this time for <code>'rectangular</code> object</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-symbol">'rectangular</span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>)))</code></pre>
<p>apply-generic applies operation 'magnitude for 'rectangular type to content of rectangular "package":</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">apply</span></span> (<span class="hljs-name">get</span> <span class="hljs-symbol">'magnitude</span> <span class="hljs-symbol">'rectangular</span>) (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))</code></pre>
<p>which is <code>magnitude</code> function from inside rectangular package</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> <span class="hljs-number">3</span> <span class="hljs-number">4</span>))
(<span class="hljs-name"><span class="hljs-built_in">sqrt</span></span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">square</span> <span class="hljs-number">3</span>)
         (<span class="hljs-name">square</span> <span class="hljs-number">4</span>)))
<span class="hljs-number">5</span></code></pre>
<h2 id="exercise-278">Exercise 2.78</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">attach-tag</span> type-tag contents)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">eq?</span></span> type-tag <span class="hljs-symbol">'scheme-number</span>)
    contents
    (<span class="hljs-name"><span class="hljs-built_in">cons</span></span> type-tag contents)
  )
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">type-tag</span> datum)
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span>
    ((<span class="hljs-name"><span class="hljs-built_in">number?</span></span> datum) <span class="hljs-symbol">'scheme-number</span>)
    ((<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> datum) (<span class="hljs-name"><span class="hljs-built_in">car</span></span> datum))
    (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"Bad tagged datum -- TYPE-TAG"</span> datum))
  )
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">contents</span> datum)
  (<span class="hljs-name"><span class="hljs-built_in">cond</span></span>
    ((<span class="hljs-name"><span class="hljs-built_in">number?</span></span> datum) datum)
    ((<span class="hljs-name"><span class="hljs-built_in">pair?</span></span> datum) (<span class="hljs-name"><span class="hljs-built_in">cdr</span></span> datum))
    (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name">error</span> <span class="hljs-string">"Bad tagged datum -- CONTENTS"</span> datum))
  )
)</code></pre>
<p>To test:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">add</span> x y) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'add</span> x y))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sub</span> x y) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'sub</span> x y))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">mul</span> x y) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'mul</span> x y))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">div</span> x y) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'div</span> x y))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">install-scheme-number-package</span>)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">tag</span> x)
    (<span class="hljs-name">attach-tag</span> <span class="hljs-symbol">'scheme-number</span> x))    
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'add</span> '(scheme-number scheme-number)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'sub</span> '(scheme-number scheme-number)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'mul</span> '(scheme-number scheme-number)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name"><span class="hljs-built_in">*</span></span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'div</span> '(scheme-number scheme-number)
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name">tag</span> (<span class="hljs-name"><span class="hljs-built_in">/</span></span> x y))))
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'make</span> <span class="hljs-symbol">'scheme-number</span>
       (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x) (<span class="hljs-name">tag</span> x)))
  <span class="hljs-symbol">'done</span>)
(<span class="hljs-name">install-scheme-number-package</span>)</code></pre>
<h2 id="exercise-279">Exercise 2.79</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name">put</span> <span class="hljs-symbol">'equ?</span> '(scheme-number scheme-number) =)

(<span class="hljs-name">put</span> <span class="hljs-symbol">'equ?</span> '(complex complex)
     (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x y) (<span class="hljs-name"><span class="hljs-built_in">and</span></span>
        (<span class="hljs-name"><span class="hljs-built_in">=</span></span> (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> x) (<span class="hljs-name"><span class="hljs-built_in">real-part</span></span> y))
        (<span class="hljs-name"><span class="hljs-built_in">=</span></span> (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> x) (<span class="hljs-name"><span class="hljs-built_in">imag-part</span></span> y))
    ))
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">equ?</span> x y) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'equ?</span> x y))</code></pre>
<h2 id="exercise-280">Exercise 2.80</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name">put</span> <span class="hljs-symbol">'zero?</span> '(scheme-number)
     (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x) (<span class="hljs-name"><span class="hljs-built_in">=</span></span> x <span class="hljs-number">0</span>))
)
(<span class="hljs-name">put</span> <span class="hljs-symbol">'zero?</span> '(complex)
     (<span class="hljs-name"><span class="hljs-built_in">lambda</span></span> (x) (<span class="hljs-name"><span class="hljs-built_in">=</span></span> (<span class="hljs-name"><span class="hljs-built_in">magnitude</span></span> x) <span class="hljs-number">0</span>))
)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name"><span class="hljs-built_in">zero?</span></span> x) (<span class="hljs-name">apply-generic</span> <span class="hljs-symbol">'zero?</span> x))</code></pre></div></article><div><div id="disqus_thread"></div></div><nav><a href="/">Home</a><a href="#top">Back to top</a></nav><footer>© <!-- -->2022<!-- --> Bunyk Taras. Built with Next.js</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"sicp2.5.1","title":"SICP 2.5.1 Generic arithmetic operations","date":"2020-09-02T17:27:13.000Z","tags":["SICP"],"updated_at":"2022-10-10T22:49:27+02:00","content":"\u003cp\u003eIn \u003ca href=\"/posts/sicp2.4\"\u003eprevious post\u003c/a\u003e I have used wrong StackOverflow answer. :) Or, to be more precise, right answer for that section, but useless here, as we want to store in table functions for multiple arguments.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/a/19114031/816449\"\u003eCorrect answer\u003c/a\u003e that supports lists looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003emake-hash-table\u003c/span\u003e))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e op type proc)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/put!\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) proc))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e op type)\n  (\u003cspan class=\"hljs-name\"\u003ehash-table/get\u003c/span\u003e *op-table* (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e op type) \u003cspan class=\"hljs-literal\"\u003e#f\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAlso I needed to copypaste a lot of code to be able to start working on \u003ca href=\"#exercise-277\"\u003efirst exercise\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e type-tag contents)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e type-tag contents))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etype-tag\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- TYPE-TAG\"\u003c/span\u003e datum)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003econtents\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e datum)\n      (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- CONTENTS\"\u003c/span\u003e datum)))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e op . args)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003etype-tags\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e type-tag args)))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eproc\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e op type-tags)))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e proc\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eapply\u003c/span\u003e\u003c/span\u003e proc (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emap\u003c/span\u003e\u003c/span\u003e contents args))\n          (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e\n            \u003cspan class=\"hljs-string\"\u003e\"No method for these types -- APPLY-GENERIC\"\u003c/span\u003e\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elist\u003c/span\u003e\u003c/span\u003e op type-tags))))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e z))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e z))\n\n\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e x y))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z))\n             (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z)))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eatan\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z)))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecos\u003c/span\u003e\u003c/span\u003e a)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003esin\u003c/span\u003e\u003c/span\u003e a))))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to the rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e x))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(rectangular) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(rectangular) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(rectangular) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(rectangular) angle)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-polar-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e r a))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecos\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003esin\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e y)))\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eatan\u003c/span\u003e\u003c/span\u003e y x)))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to the rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e x))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(polar) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(polar) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(polar) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(polar) angle)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e \n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-rectangular-package\u003c/span\u003e)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-complex-package\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e;; imported procedures from rectangular and polar packages\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y)\n    ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e) x y))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a)\n    ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'polar\u003c/span\u003e) r a))\n  \u003cspan class=\"hljs-comment\"\u003e;; internal procedures\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z2))\n                         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e z2))\n                         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z2))\n                       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z2))))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-complex\u003c/span\u003e z1 z2)\n    (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z2))\n                       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eangle\u003c/span\u003e\u003c/span\u003e z2))))\n  \u003cspan class=\"hljs-comment\"\u003e;; interface to rest of the system\u003c/span\u003e\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e z) (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e z))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e '(complex complex)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (z1 z2) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv-complex\u003c/span\u003e z1 z2))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-real-imag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-real-imag\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make-from-mag-ang\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (r a) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e '(complex) real-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e '(complex) imag-part)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e '(complex) magnitude)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e '(complex) angle)\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-complex-package\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-277\"\u003eExercise 2.77\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e z (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e z)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt calls \u003ccode\u003eapply-generic\u003c/code\u003e to do operation \u003ccode\u003e'magnitude\u003c/code\u003e with z\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eapply-generic\u003c/code\u003e looks for operation \u003ccode\u003e'magnitude\u003c/code\u003e for \u003ccode\u003e'complex\u003c/code\u003e numbers, and applies it to value inside\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eapply\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'complex\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat operation, thanks to Alyssa P. Hacker, is just application of same \u003ccode\u003emagnitude\u003c/code\u003e function, but this time for \u003ccode\u003e'rectangular\u003c/code\u003e object\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eapply-generic applies operation 'magnitude for 'rectangular type to content of rectangular \"package\":\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eapply\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'rectangular\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhich is \u003ccode\u003emagnitude\u003c/code\u003e function from inside rectangular package\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003esqrt\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e)\n         (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e)))\n\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-278\"\u003eExercise 2.78\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e type-tag contents)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeq?\u003c/span\u003e\u003c/span\u003e type-tag \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e)\n    contents\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econs\u003c/span\u003e\u003c/span\u003e type-tag contents)\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etype-tag\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enumber?\u003c/span\u003e\u003c/span\u003e datum) \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecar\u003c/span\u003e\u003c/span\u003e datum))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- TYPE-TAG\"\u003c/span\u003e datum))\n  )\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003econtents\u003c/span\u003e datum)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enumber?\u003c/span\u003e\u003c/span\u003e datum) datum)\n    ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003epair?\u003c/span\u003e\u003c/span\u003e datum) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ecdr\u003c/span\u003e\u003c/span\u003e datum))\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Bad tagged datum -- CONTENTS\"\u003c/span\u003e datum))\n  )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo test:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esub\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emul\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e x y))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e x y))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-scheme-number-package\u003c/span\u003e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x)\n    (\u003cspan class=\"hljs-name\"\u003eattach-tag\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e x))    \n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'add\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'sub\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'mul\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'div\u003c/span\u003e '(scheme-number scheme-number)\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e x y))))\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'make\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'scheme-number\u003c/span\u003e\n       (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003etag\u003c/span\u003e x)))\n  \u003cspan class=\"hljs-symbol\"\u003e'done\u003c/span\u003e)\n(\u003cspan class=\"hljs-name\"\u003einstall-scheme-number-package\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-279\"\u003eExercise 2.79\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e '(scheme-number scheme-number) =)\n\n(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e '(complex complex)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x y) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eand\u003c/span\u003e\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ereal-part\u003c/span\u003e\u003c/span\u003e y))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eimag-part\u003c/span\u003e\u003c/span\u003e y))\n    ))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eequ?\u003c/span\u003e x y) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'equ?\u003c/span\u003e x y))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-280\"\u003eExercise 2.80\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e '(scheme-number)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e '(complex)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003elambda\u003c/span\u003e\u003c/span\u003e (x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003emagnitude\u003c/span\u003e\u003c/span\u003e x) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003ezero?\u003c/span\u003e\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003eapply-generic\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'zero?\u003c/span\u003e x))\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.5.1"},"buildId":"eCLc5qo0ajB_-kSJKK-oM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>