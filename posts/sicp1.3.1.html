<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>SICP 1.3.1 Procedures as arguments</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/b53cc6ef9e9e352d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b53cc6ef9e9e352d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-959cc2ac3c742fb4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b654c501598b6a83.js" defer=""></script><script src="/_next/static/chunks/996-372da0b0d3708a80.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-e5a68c245444f298.js" defer=""></script><script src="/_next/static/aEOOGhU5jGmktyA5gbLEu/_buildManifest.js" defer=""></script><script src="/_next/static/aEOOGhU5jGmktyA5gbLEu/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><h1 id="top">Taras Bunyk</h1><nav><a href="/">Home</a><a href="http://bunyk.github.io/mandala/">Snowflake drawing</a><a href="/resume">Resume</a><a href="/pages/sudoku.html">Sudoku fall</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><article><h1>SICP 1.3.1 Procedures as arguments</h1><div><em>Published: 2020-06-27T17:32:06.000Z</em></div><div><p>Solving more exercises, trying not to skip to be able to learn next chapters better.</p>
<h2 id="exercise-129-simpson-rule-integration">Exercise 1.29 Simpson rule integration</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">cube</span> x) (<span class="hljs-name"><span class="hljs-built_in">*</span></span> x x x))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">integral</span> f a b dx)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">add-dx</span> x) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> x dx))
  (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name">sum</span> f (<span class="hljs-name"><span class="hljs-built_in">+</span></span> a (<span class="hljs-name"><span class="hljs-built_in">/</span></span> dx <span class="hljs-number">2.0</span>)) add-dx b)
     dx))

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sum</span> term a next b)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
      <span class="hljs-number">0</span>
      (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">term</span> a)
         (<span class="hljs-name">sum</span> term (<span class="hljs-name">next</span> a) next b))))

(<span class="hljs-name">integral</span> cube <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0.01</span>)
<span class="hljs-comment">; .24998750000000042</span>
(<span class="hljs-name">integral</span> cube <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0.001</span>)
<span class="hljs-comment">;.249999875000001</span>

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">simpson-rule-integral</span> f a b n)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">inc</span> x) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> x <span class="hljs-number">1</span>))
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">term</span> i)
    (<span class="hljs-name"><span class="hljs-built_in">cond</span></span>
      ((<span class="hljs-name"><span class="hljs-built_in">=</span></span> i <span class="hljs-number">0</span>) (<span class="hljs-name">f</span> a))
      ((<span class="hljs-name"><span class="hljs-built_in">=</span></span> i n) (<span class="hljs-name">f</span> b))
      ((<span class="hljs-name"><span class="hljs-built_in">even?</span></span> i) (<span class="hljs-name"><span class="hljs-built_in">*</span></span> <span class="hljs-number">2</span> (<span class="hljs-name">f</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> a (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name"><span class="hljs-built_in">/</span></span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> b a) n) i)))))
      (<span class="hljs-name"><span class="hljs-built_in">else</span></span> (<span class="hljs-name"><span class="hljs-built_in">*</span></span> <span class="hljs-number">4</span> (<span class="hljs-name">f</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> a (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name"><span class="hljs-built_in">/</span></span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> b a) n) i)))))
    )
  )
  (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name">sum</span> term <span class="hljs-number">0</span> inc n)
     (<span class="hljs-name"><span class="hljs-built_in">/</span></span> (<span class="hljs-name"><span class="hljs-built_in">-</span></span> b a) n <span class="hljs-number">3</span>))
)

(<span class="hljs-name">simpson-rule-integral</span> cube <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">10</span>)
<span class="hljs-comment">;Value: 1/4</span>
</code></pre>
<p>Seems to work very precise. Gives rational numbers, wow. Even when try with different functions:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">identity</span> x) x)
(<span class="hljs-name">simpson-rule-integral</span> identity <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">10</span>)
<span class="hljs-comment">;Value: 1/2</span></code></pre>
<h2 id="exercise-130-iterative-summation">Exercise 1.30 Iterative summation</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sum</span> term a next b)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> a result)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
        result
        (<span class="hljs-name">iter</span> (<span class="hljs-name">next</span> a) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> (<span class="hljs-name">term</span> a) result))))
  (<span class="hljs-name">iter</span> a <span class="hljs-number">0</span>))</code></pre>
<h2 id="exercise-131-product">Exercise 1.31 Product</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">product</span> term a next b)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> a result)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
        result
        (<span class="hljs-name">iter</span> (<span class="hljs-name">next</span> a) (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name">term</span> a) result))))
  (<span class="hljs-name">iter</span> a <span class="hljs-number">1</span>))</code></pre>
<p>Factorial:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">inc</span> i) (<span class="hljs-name"><span class="hljs-built_in">+</span></span> i <span class="hljs-number">1</span>))
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">identity</span> x) x)
(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">factorial</span> n) (<span class="hljs-name">product</span> identity <span class="hljs-number">1</span> inc n))</code></pre>
<p>Approximating Pi:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">pi</span> precision) 
    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">term</span> i)
        (<span class="hljs-name"><span class="hljs-built_in">define</span></span> k (<span class="hljs-name"><span class="hljs-built_in">*</span></span> i <span class="hljs-number">2</span>))
        (<span class="hljs-name"><span class="hljs-built_in">/</span></span> (<span class="hljs-name"><span class="hljs-built_in">*</span></span> k (<span class="hljs-name"><span class="hljs-built_in">+</span></span> k <span class="hljs-number">2</span>)) (<span class="hljs-name">square</span> (<span class="hljs-name"><span class="hljs-built_in">+</span></span> k <span class="hljs-number">1</span>)))
    )
    (<span class="hljs-name"><span class="hljs-built_in">*</span></span> <span class="hljs-number">4.0</span> (<span class="hljs-name">product</span> term <span class="hljs-number">1</span> inc precision))
)
(<span class="hljs-name">pi</span> <span class="hljs-number">100</span>)
<span class="hljs-comment">;Value: 3.1493784731686008</span></code></pre>
<p>Recursive product:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">product</span> term a next b)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
        <span class="hljs-number">1</span>
        (<span class="hljs-name"><span class="hljs-built_in">*</span></span> (<span class="hljs-name">term</span> a) (<span class="hljs-name">product</span> term (<span class="hljs-name">next</span> a) next b))
    )
)</code></pre>
<h2 id="exercise-132-accumulate">Exercise 1.32: Accumulate</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">accumulate</span> combiner null-value term a next b)
  (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
    null-value
    (<span class="hljs-name">combiner</span>
      (<span class="hljs-name">term</span> a)
      (<span class="hljs-name">accumulate</span> combiner null-value term (<span class="hljs-name">next</span> a) next b)
    )
  )
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sum</span> term a next b)
  (<span class="hljs-name">accumulate</span> + <span class="hljs-number">0</span> term a next b)
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">product</span> term a next b)
  (<span class="hljs-name">accumulate</span> * <span class="hljs-number">1</span> term a next b)
)</code></pre>
<p>Iterative:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">accumulate</span> combiner null-value term a next b)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> a result)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
      result
      (<span class="hljs-name">iter</span> (<span class="hljs-name">next</span> a) (<span class="hljs-name">combiner</span> (<span class="hljs-name">term</span> a) result))
    )
  )
  (<span class="hljs-name">iter</span> a null-value)
)</code></pre>
<h2 id="exercise-133-filtered-accumulate">Exercise 1.33 Filtered accumulate</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">filtered-accumulate</span> combiner null-value term a next b filter)
  (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">iter</span> a result)
    (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name"><span class="hljs-built_in">></span></span> a b)
      result
      (<span class="hljs-name"><span class="hljs-built_in">if</span></span> (<span class="hljs-name">filter</span> a) 
          (<span class="hljs-name">iter</span> (<span class="hljs-name">next</span> a) result)
          (<span class="hljs-name">iter</span> (<span class="hljs-name">next</span> a) (<span class="hljs-name">combiner</span> (<span class="hljs-name">term</span> a) result))
      )
    )
  )
  (<span class="hljs-name">iter</span> a null-value)
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">sum-of-squares-of-primes-in-interval</span> a b)
    (<span class="hljs-name">filtered-accumulate</span> + <span class="hljs-number">0</span> sqr a inc b prime?)
)

(<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">product-of-relatively-primes-to</span> n)
    (<span class="hljs-name"><span class="hljs-built_in">define</span></span> (<span class="hljs-name">!rel-prime</span> x)
      (<span class="hljs-name"><span class="hljs-built_in">not</span></span> (<span class="hljs-name"><span class="hljs-built_in">=</span></span> (<span class="hljs-name"><span class="hljs-built_in">gcd</span></span> x n) <span class="hljs-number">1</span>))
    )
    (<span class="hljs-name">filtered-accumulate</span> * <span class="hljs-number">1</span> identity <span class="hljs-number">1</span> inc n !rel-prime)
)</code></pre></div></article><div><div id="disqus_thread"></div></div><nav><a href="/">Home</a><a href="#top">Back to top</a></nav><footer>© <!-- -->2025<!-- --> Bunyk Taras. Built with Next.js</footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"sicp1.3.1","title":"SICP 1.3.1 Procedures as arguments","date":"2020-06-27T17:32:06.000Z","tags":["SICP"],"updated_at":"2021-04-20T00:38:16+02:00","content":"\u003cp\u003eSolving more exercises, trying not to skip to be able to learn next chapters better.\u003c/p\u003e\n\u003ch2 id=\"exercise-129-simpson-rule-integration\"\u003eExercise 1.29 Simpson rule integration\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecube\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e x x x))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eintegral\u003c/span\u003e f a b dx)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eadd-dx\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e x dx))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e f (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e a (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e dx \u003cspan class=\"hljs-number\"\u003e2.0\u003c/span\u003e)) add-dx b)\n     dx))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e term a next b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n      \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a)\n         (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e term (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) next b))))\n\n(\u003cspan class=\"hljs-name\"\u003eintegral\u003c/span\u003e cube \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.01\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e; .24998750000000042\u003c/span\u003e\n(\u003cspan class=\"hljs-name\"\u003eintegral\u003c/span\u003e cube \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0.001\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e;.249999875000001\u003c/span\u003e\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esimpson-rule-integral\u003c/span\u003e f a b n)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einc\u003c/span\u003e x) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e x \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e i)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003econd\u003c/span\u003e\u003c/span\u003e\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e a))\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e i n) (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e b))\n      ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eeven?\u003c/span\u003e\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e a (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e b a) n) i)))))\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ef\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e a (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e b a) n) i)))))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e term \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e inc n)\n     (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e-\u003c/span\u003e\u003c/span\u003e b a) n \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e))\n)\n\n(\u003cspan class=\"hljs-name\"\u003esimpson-rule-integral\u003c/span\u003e cube \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e;Value: 1/4\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSeems to work very precise. Gives rational numbers, wow. Even when try with different functions:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eidentity\u003c/span\u003e x) x)\n(\u003cspan class=\"hljs-name\"\u003esimpson-rule-integral\u003c/span\u003e identity \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e;Value: 1/2\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-130-iterative-summation\"\u003eExercise 1.30 Iterative summation\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e term a next b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a result)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n        result\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a) result))))\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-131-product\"\u003eExercise 1.31 Product\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e term a next b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a result)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n        result\n        (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a) result))))\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFactorial:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einc\u003c/span\u003e i) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eidentity\u003c/span\u003e x) x)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003efactorial\u003c/span\u003e n) (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e identity \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e inc n))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eApproximating Pi:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003epi\u003c/span\u003e precision) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e i)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e k (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e i \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e/\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e k (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)) (\u003cspan class=\"hljs-name\"\u003esquare\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e+\u003c/span\u003e\u003c/span\u003e k \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)))\n    )\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e4.0\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e term \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e inc precision))\n)\n(\u003cspan class=\"hljs-name\"\u003epi\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e;Value: 3.1493784731686008\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eRecursive product:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e term a next b)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n        \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e*\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e term (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) next b))\n    )\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-132-accumulate\"\u003eExercise 1.32: Accumulate\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e combiner null-value term a next b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n    null-value\n    (\u003cspan class=\"hljs-name\"\u003ecombiner\u003c/span\u003e\n      (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a)\n      (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e combiner null-value term (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) next b)\n    )\n  )\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e term a next b)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e term a next b)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct\u003c/span\u003e term a next b)\n  (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e term a next b)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIterative:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eaccumulate\u003c/span\u003e combiner null-value term a next b)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a result)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n      result\n      (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003ecombiner\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a) result))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a null-value)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"exercise-133-filtered-accumulate\"\u003eExercise 1.33 Filtered accumulate\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003efiltered-accumulate\u003c/span\u003e combiner null-value term a next b filter)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a result)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e\u003e\u003c/span\u003e\u003c/span\u003e a b)\n      result\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003efilter\u003c/span\u003e a) \n          (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) result)\n          (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003enext\u003c/span\u003e a) (\u003cspan class=\"hljs-name\"\u003ecombiner\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eterm\u003c/span\u003e a) result))\n      )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eiter\u003c/span\u003e a null-value)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum-of-squares-of-primes-in-interval\u003c/span\u003e a b)\n    (\u003cspan class=\"hljs-name\"\u003efiltered-accumulate\u003c/span\u003e + \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e sqr a inc b prime?)\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eproduct-of-relatively-primes-to\u003c/span\u003e n)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e!rel-prime\u003c/span\u003e x)\n      (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003enot\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003e=\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-built_in\"\u003egcd\u003c/span\u003e\u003c/span\u003e x n) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n    )\n    (\u003cspan class=\"hljs-name\"\u003efiltered-accumulate\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e identity \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e inc n !rel-prime)\n)\u003c/code\u003e\u003c/pre\u003e"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp1.3.1"},"buildId":"aEOOGhU5jGmktyA5gbLEu","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>