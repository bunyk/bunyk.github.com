<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>SICP 2.4 Multiple representations for abstract data</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/688040b3fc223486cedc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/688040b3fc223486cedc.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons-131aad2d92e69c360009.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-4f9408d32df08544de44.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" as="script"/><link rel="preload" href="/_next/static/chunks/762-bec077d9715dbffe23e5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-4d391b18df3a2ccf9664.js" as="script"/></head><body><div id="__next"><div class="MuiContainer-root MuiContainer-maxWidthMd"><div class="MuiToolbar-root MuiToolbar-regular jss1 MuiToolbar-gutters"><h1 class="MuiTypography-root jss2 MuiTypography-h5 MuiTypography-noWrap" aligh="center">Taras Bunyk</h1></div><nav class="MuiToolbar-root MuiToolbar-dense jss3 MuiToolbar-gutters"><a href="/">Home</a><a href="/resume">Resume</a><a href="https://bunyk.wordpress.com/">Old blog (in Ukrainian)</a></nav><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-5"><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-9"><div class="MuiPaper-root MuiCard-root MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardHeader-root"><div class="MuiCardHeader-content"><span class="MuiTypography-root MuiCardHeader-title MuiTypography-h5 MuiTypography-displayBlock">SICP 2.4 Multiple representations for abstract data</span><span class="MuiTypography-root MuiCardHeader-subheader MuiTypography-body1 MuiTypography-colorTextSecondary MuiTypography-displayBlock">Published: 2020-08-26 Tags: SICP</span></div></div><div class="MuiCardContent-root"><p>I went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)</p>
<p><a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html">Link to the chapter</a></p>
<p>In this chapter we will need <code>get</code> and <code>put</code> functions which could be implemented by similar system functions.</p>
<p>Found this on <a href="https://stackoverflow.com/a/29465496/816449">StackOverflow</a>, of course.</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> put <span class="hljs-number">2</span>d-put!)
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">get</span> a b)
    <span class="hljs-comment">;(display "get ") (display a) (display b) (newline)</span>
    (<span class="hljs-name">2d-get</span> a b)
)</code></pre>
<p>And some setup from <a href="/posts/sicp2.3.2/">previous section</a>:</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> variable? symbol?)
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">same-variable?</span> v1 v2)
  (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name">variable?</span> v1) (<span class="hljs-name">variable?</span> v2) (<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> v1 v2)))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">=number?</span> exp num)
  (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">number?</span></span> exp) (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> exp num)))</code></pre>
<h2>Exercise 2.73</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">deriv</span> exp var)
   (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">number?</span></span> exp) <span class="hljs-number">0</span>)
         ((<span class="hljs-name">variable?</span> exp) (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name">same-variable?</span> exp var) <span class="hljs-number">1</span> <span class="hljs-number">0</span>))
         (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> ((<span class="hljs-name">get</span> <span class="hljs-symbol">'deriv</span> (<span class="hljs-name">operator</span> exp)) (<span class="hljs-name">operands</span> exp)
                                            var))))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">operator</span> exp) (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> exp))
(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">operands</span> exp) (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> exp))</code></pre>
<p>a) So, in our new derive we do lookup in table instead of <code>cond</code> expression. We are not able to move <code>number?</code> into lookup, because <code>number?</code> is condition for a set of values, not just one value, and table works only with one value.</p>
<p>b)</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-sum</span> args) 
    (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">sum</span> items total nonnum)
        (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span>
            ((<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> items)
                (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> nonnum)
                    total
                    (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> <span class="hljs-symbol">'+</span> (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> total <span class="hljs-number">0</span>)
                                nonnum
                                (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> total nonnum)
                    ))
                )
            )
            ((<span class="hljs-name"><span class="hljs-builtin-name">number?</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items))
                (<span class="hljs-name">sum</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> items) (<span class="hljs-name"><span class="hljs-builtin-name">+</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items) total) nonnum))
            (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span>
                (<span class="hljs-name">sum</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> items) total (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items) nonnum)))
        )
    )
    (<span class="hljs-name">sum</span> args <span class="hljs-number">0</span> '())
)

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-prod</span> m1 m2)
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">or</span></span> (<span class="hljs-name">=number?</span> m1 <span class="hljs-number">0</span>) (<span class="hljs-name">=number?</span> m2 <span class="hljs-number">0</span>)) <span class="hljs-number">0</span>)
        ((<span class="hljs-name">=number?</span> m1 <span class="hljs-number">1</span>) m2)
        ((<span class="hljs-name">=number?</span> m2 <span class="hljs-number">1</span>) m1)
        ((<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">number?</span></span> m1) (<span class="hljs-name"><span class="hljs-builtin-name">number?</span></span> m2)) (<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> m1 m2))
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-symbol">'*</span> m1 m2))))

(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">install-derivatives-package</span>) 
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">deriv-sum</span> items var)
    (<span class="hljs-name">make-sum</span> (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">lambda</span></span> (e) (<span class="hljs-name">deriv</span> e var)) items))
  )
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'deriv</span> <span class="hljs-symbol">'+</span> deriv-sum)

  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">deriv-prod</span> items var)
    (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> ((<span class="hljs-name">tail</span>
        (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">null?</span></span> (<span class="hljs-name">cddr</span> items))
            (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> items)
            (<span class="hljs-name"><span class="hljs-builtin-name">cons</span></span> <span class="hljs-symbol">'*</span> (<span class="hljs-name"><span class="hljs-builtin-name">cdr</span></span> items))
        )
    ))
        (<span class="hljs-name">make-sum</span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> 
           (<span class="hljs-name">make-prod</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items)
                      (<span class="hljs-name">deriv</span> tail var))
           (<span class="hljs-name">make-prod</span> (<span class="hljs-name">deriv</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items) var)
                      tail)
        ))
    )
  )
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'deriv</span> <span class="hljs-symbol">'+</span> deriv-sum)
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'deriv</span> <span class="hljs-symbol">'*</span> deriv-prod)
)
(<span class="hljs-name">install-derivatives-package</span>) </code></pre>
<p>I think I wrote too much code here because I wanted to support sums and products of multiple arguments.</p>
<p>c) Exponentation</p>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-exp</span> base e)
  (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name">=number?</span> e <span class="hljs-number">0</span>) <span class="hljs-number">1</span>)
        ((<span class="hljs-name">=number?</span> e <span class="hljs-number">1</span>) base)
        (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">list</span></span> <span class="hljs-symbol">'**</span> base e))))

  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">deriv-exp</span> items var)
    (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> (
        (<span class="hljs-name">base</span> (<span class="hljs-name"><span class="hljs-builtin-name">car</span></span> items))
        (<span class="hljs-name">e</span> (<span class="hljs-name"><span class="hljs-builtin-name">cadr</span></span> items))
    )
        (<span class="hljs-name">make-prod</span>
            e
            (<span class="hljs-name">make-exp</span> base (<span class="hljs-name"><span class="hljs-builtin-name">-</span></span> e <span class="hljs-number">1</span>))
        )
    )
  )
  (<span class="hljs-name">put</span> <span class="hljs-symbol">'deriv</span> <span class="hljs-symbol">'**</span> deriv-exp)

(<span class="hljs-name">deriv</span> '(+ (** x <span class="hljs-number">3</span>) (** x <span class="hljs-number">2</span>)) <span class="hljs-symbol">'x</span>)</code></pre>
<p>d) We could switch arguments inside <code>get</code>, or inside <code>put</code>, or switch arguments when we call put. That's all what will be needed.</p>
<h2>Exercise 2.74</h2>
<p>I skipped it because it is too abstract.</p>
<h2>Exercise 2.75</h2>
<pre><code class="hljs language-scheme">(<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">make-from-mag-ang</span> r a) 
  (<span class="hljs-name"><span class="hljs-builtin-name">define</span></span> (<span class="hljs-name">dispatch</span> op)
    (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span> ((<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> op <span class="hljs-symbol">'real-part</span>) (<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> r (<span class="hljs-name"><span class="hljs-builtin-name">cos</span></span> a)))
          ((<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> op <span class="hljs-symbol">'imag-part</span>) (<span class="hljs-name"><span class="hljs-builtin-name">*</span></span> r (<span class="hljs-name"><span class="hljs-builtin-name">sin</span></span> a)))
          ((<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> op <span class="hljs-symbol">'magnitude</span>) r)
          ((<span class="hljs-name"><span class="hljs-builtin-name">eq?</span></span> op <span class="hljs-symbol">'angle</span>) a)
          (<span class="hljs-name"><span class="hljs-builtin-name">else</span></span>
           (<span class="hljs-name">error</span> <span class="hljs-string">"Unknown op -- MAKE-FROM-REAL-IMAG"</span> op))))
  dispatch)</code></pre>
<h2>Exercise 2.76</h2>
<p>Skip this too. Because I see no way to verify that I did it correctly. Learning needs feedback.</p></div></div></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-3"><h6 class="MuiTypography-root jss5 MuiTypography-h6 MuiTypography-gutterBottom">Archives</h6><ul><li><a href="/month/2018-12/page/1">2018-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2020-06/page/1">2020-06</a> <span title="posts count">(<!-- -->7<!-- -->)</span></li><li><a href="/month/2020-07/page/1">2020-07</a> <span title="posts count">(<!-- -->10<!-- -->)</span></li><li><a href="/month/2020-08/page/1">2020-08</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-09/page/1">2020-09</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/month/2020-12/page/1">2020-12</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/month/2021-01/page/1">2021-01</a> <span title="posts count">(<!-- -->4<!-- -->)</span></li></ul><h6 class="MuiTypography-root jss5 MuiTypography-h6 MuiTypography-gutterBottom">Topics</h6><ul><li><a href="/tag/MOOC/page/1">MOOC</a> <span title="posts count">(<!-- -->2<!-- -->)</span></li><li><a href="/tag/SICP/page/1">SICP</a> <span title="posts count">(<!-- -->20<!-- -->)</span></li><li><a href="/tag/ideas/page/1">ideas</a> <span title="posts count">(<!-- -->1<!-- -->)</span></li><li><a href="/tag/notes/page/1">notes</a> <span title="posts count">(<!-- -->5<!-- -->)</span></li><li><a href="/tag/on%20writing/page/1">on writing</a> <span title="posts count">(<!-- -->3<!-- -->)</span></li></ul></div><p class="MuiTypography-root MuiTypography-body2 MuiTypography-colorTextSecondary MuiTypography-alignCenter">© <!-- -->2021<!-- --> Bunyk Taras. Built with Material UI &amp; Next.js</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"sicp2.4","title":"SICP 2.4 Multiple representations for abstract data","date":"2020-08-26","tags":["SICP"],"excerpt":"\u003cp\u003eI went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html\"\u003eLink to the chapter\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn this chapter we will need \u003ccode\u003eget\u003c/code\u003e and \u003ccode\u003eput\u003c/code\u003e functions which could be implemented by similar system functions.\u003c/p\u003e\n\u003cp\u003eFound this on \u003ca href=\"https://stackoverflow.com/a/29465496/816449\"\u003eStackOverflow\u003c/a\u003e, of course.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e put \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003ed-put!)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e a b)\n    \u003cspan class=\"hljs-comment\"\u003e;(display \"get \") (display a) (display b) (newline)\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e2d-get\u003c/span\u003e a b)\n)\u003c/code\u003e\u003c/pre\u003e","content":"\u003cp\u003eI went on vacation and lost cadence on this project. Need to get back on track, remember how to lauch interpreter, etc. :)\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-17.html\"\u003eLink to the chapter\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn this chapter we will need \u003ccode\u003eget\u003c/code\u003e and \u003ccode\u003eput\u003c/code\u003e functions which could be implemented by similar system functions.\u003c/p\u003e\n\u003cp\u003eFound this on \u003ca href=\"https://stackoverflow.com/a/29465496/816449\"\u003eStackOverflow\u003c/a\u003e, of course.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e put \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003ed-put!)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e a b)\n    \u003cspan class=\"hljs-comment\"\u003e;(display \"get \") (display a) (display b) (newline)\u003c/span\u003e\n    (\u003cspan class=\"hljs-name\"\u003e2d-get\u003c/span\u003e a b)\n)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd some setup from \u003ca href=\"/posts/sicp2.3.2/\"\u003eprevious section\u003c/a\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e variable? symbol?)\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e v1 v2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v1) (\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e v2) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e v1 v2)))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e exp num)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e exp num)))\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.73\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e exp var)\n   (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e exp) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n         ((\u003cspan class=\"hljs-name\"\u003evariable?\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esame-variable?\u003c/span\u003e exp var) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e))\n         (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003eget\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperator\u003c/span\u003e exp)) (\u003cspan class=\"hljs-name\"\u003eoperands\u003c/span\u003e exp)\n                                            var))))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperator\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e exp))\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003eoperands\u003c/span\u003e exp) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e exp))\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ea) So, in our new derive we do lookup in table instead of \u003ccode\u003econd\u003c/code\u003e expression. We are not able to move \u003ccode\u003enumber?\u003c/code\u003e into lookup, because \u003ccode\u003enumber?\u003c/code\u003e is condition for a set of values, not just one value, and table works only with one value.\u003c/p\u003e\n\u003cp\u003eb)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e args) \n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e items total nonnum)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e\n            ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e items)\n                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e nonnum)\n                    total\n                    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e=\u003c/span\u003e\u003c/span\u003e total \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n                                nonnum\n                                (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e total nonnum)\n                    ))\n                )\n            )\n            ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items))\n                (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e+\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) total) nonnum))\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n                (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items) total (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) nonnum)))\n        )\n    )\n    (\u003cspan class=\"hljs-name\"\u003esum\u003c/span\u003e args \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e '())\n)\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e m1 m2)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eor\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)) \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m1 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m2)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e m2 \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) m1)\n        ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eand\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m1) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enumber?\u003c/span\u003e\u003c/span\u003e m2)) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e m1 m2))\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e m1 m2))))\n\n(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003einstall-derivatives-package\u003c/span\u003e) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-sum\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003emap\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elambda\u003c/span\u003e\u003c/span\u003e (e) (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e e var)) items))\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e deriv-sum)\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-prod\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003etail\u003c/span\u003e\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eif\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003enull?\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ecddr\u003c/span\u003e items))\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e items)\n            (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econs\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecdr\u003c/span\u003e\u003c/span\u003e items))\n        )\n    ))\n        (\u003cspan class=\"hljs-name\"\u003emake-sum\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \n           (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items)\n                      (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e tail var))\n           (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items) var)\n                      tail)\n        ))\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'+\u003c/span\u003e deriv-sum)\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'*\u003c/span\u003e deriv-prod)\n)\n(\u003cspan class=\"hljs-name\"\u003einstall-derivatives-package\u003c/span\u003e) \u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI think I wrote too much code here because I wanted to support sums and products of multiple arguments.\u003c/p\u003e\n\u003cp\u003ec) Exponentation\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-exp\u003c/span\u003e base e)\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n        ((\u003cspan class=\"hljs-name\"\u003e=number?\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) base)\n        (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elist\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e base e))))\n\n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003ederiv-exp\u003c/span\u003e items var)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003elet\u003c/span\u003e\u003c/span\u003e (\n        (\u003cspan class=\"hljs-name\"\u003ebase\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecar\u003c/span\u003e\u003c/span\u003e items))\n        (\u003cspan class=\"hljs-name\"\u003ee\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecadr\u003c/span\u003e\u003c/span\u003e items))\n    )\n        (\u003cspan class=\"hljs-name\"\u003emake-prod\u003c/span\u003e\n            e\n            (\u003cspan class=\"hljs-name\"\u003emake-exp\u003c/span\u003e base (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e-\u003c/span\u003e\u003c/span\u003e e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e))\n        )\n    )\n  )\n  (\u003cspan class=\"hljs-name\"\u003eput\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'deriv\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003e'**\u003c/span\u003e deriv-exp)\n\n(\u003cspan class=\"hljs-name\"\u003ederiv\u003c/span\u003e '(+ (** x \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e) (** x \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)) \u003cspan class=\"hljs-symbol\"\u003e'x\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ed) We could switch arguments inside \u003ccode\u003eget\u003c/code\u003e, or inside \u003ccode\u003eput\u003c/code\u003e, or switch arguments when we call put. That's all what will be needed.\u003c/p\u003e\n\u003ch2\u003eExercise 2.74\u003c/h2\u003e\n\u003cp\u003eI skipped it because it is too abstract.\u003c/p\u003e\n\u003ch2\u003eExercise 2.75\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-scheme\"\u003e(\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003emake-from-mag-ang\u003c/span\u003e r a) \n  (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003edefine\u003c/span\u003e\u003c/span\u003e (\u003cspan class=\"hljs-name\"\u003edispatch\u003c/span\u003e op)\n    (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003econd\u003c/span\u003e\u003c/span\u003e ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'real-part\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003ecos\u003c/span\u003e\u003c/span\u003e a)))\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'imag-part\u003c/span\u003e) (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003e*\u003c/span\u003e\u003c/span\u003e r (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003esin\u003c/span\u003e\u003c/span\u003e a)))\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'magnitude\u003c/span\u003e) r)\n          ((\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eeq?\u003c/span\u003e\u003c/span\u003e op \u003cspan class=\"hljs-symbol\"\u003e'angle\u003c/span\u003e) a)\n          (\u003cspan class=\"hljs-name\"\u003e\u003cspan class=\"hljs-builtin-name\"\u003eelse\u003c/span\u003e\u003c/span\u003e\n           (\u003cspan class=\"hljs-name\"\u003eerror\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"Unknown op -- MAKE-FROM-REAL-IMAG\"\u003c/span\u003e op))))\n  dispatch)\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExercise 2.76\u003c/h2\u003e\n\u003cp\u003eSkip this too. Because I see no way to verify that I did it correctly. Learning needs feedback.\u003c/p\u003e"},"archives":[{"url":"/month/2018-12/page/1","id":"2018-12","count":1,"title":"2018-12"},{"url":"/month/2020-06/page/1","id":"2020-06","count":7,"title":"2020-06"},{"url":"/month/2020-07/page/1","id":"2020-07","count":10,"title":"2020-07"},{"url":"/month/2020-08/page/1","id":"2020-08","count":2,"title":"2020-08"},{"url":"/month/2020-09/page/1","id":"2020-09","count":2,"title":"2020-09"},{"url":"/month/2020-12/page/1","id":"2020-12","count":1,"title":"2020-12"},{"url":"/month/2021-01/page/1","id":"2021-01","count":4,"title":"2021-01"}],"topics":[{"url":"/tag/MOOC/page/1","id":"MOOC","title":"MOOC","count":2},{"url":"/tag/SICP/page/1","id":"SICP","title":"SICP","count":20},{"url":"/tag/ideas/page/1","id":"ideas","title":"ideas","count":1},{"url":"/tag/notes/page/1","id":"notes","title":"notes","count":5},{"url":"/tag/on writing/page/1","id":"on writing","title":"on writing","count":3}]},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"sicp2.4"},"buildId":"ldCo0kqBhAVZTdpBtUtDg","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-ab63730ce14ffb2d4de2.js" async=""></script><script src="/_next/static/chunks/framework-77b689d02b4bf42ce2e0.js" async=""></script><script src="/_next/static/chunks/commons-131aad2d92e69c360009.js" async=""></script><script src="/_next/static/chunks/main-4f9408d32df08544de44.js" async=""></script><script src="/_next/static/chunks/pages/_app-d383b5fdcc7af26c9ab8.js" async=""></script><script src="/_next/static/chunks/762-bec077d9715dbffe23e5.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4d391b18df3a2ccf9664.js" async=""></script><script src="/_next/static/ldCo0kqBhAVZTdpBtUtDg/_buildManifest.js" async=""></script><script src="/_next/static/ldCo0kqBhAVZTdpBtUtDg/_ssgManifest.js" async=""></script></body></html>